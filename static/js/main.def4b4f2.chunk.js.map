{"version":3,"sources":["Jsons sync /^/.*$","View/DetailPage sync /^.*$","View/DetailPage/marker_icon.svg","serviceWorker.ts","Model/Viewport.ts","View/MapPage/FeatureInfo.tsx","View/MapPage/StationInfo.tsx","View/MapPage/Map.tsx","Model/MapPin.ts","Controller/MapPage/MapConfiguration.ts","Model/Polygon.ts","Controller/TestConfiguration.ts","Controller/FeatureProvider.ts","Controller/FROST/MockDataProvider.ts","Controller/MapPage/NearConfiguration.ts","Controller/MapPage/PolygonConfiguration.ts","Controller/MapPage/StationConfiguration.ts","Controller/Storage/MapConfigurationMemory.ts","Controller/MapPage/MapController.ts","View/MapPage/FeatureSelect.tsx","View/MapPage/Search.tsx","View/MapPage/Legend.tsx","View/MapPage/MapPage.tsx","View/ErrorPage.tsx","View/About.tsx","View/PrivacyPolicy.tsx","View/Layout/LanguageMenu.tsx","View/Layout/PageMenu.tsx","View/Layout/Layout.tsx","index.tsx","Model/Position.ts","Controller/Storage/Language.ts","Model/Color.ts","Model/Observation.ts","Model/ObservationStation.ts","Controller/MockDataProvider.ts","Model/Scale.ts","Controller/DiagramController/DiagramController.ts","Model/Timespan.ts","Controller/DiagramController/FeatureHistoryLineChartController.ts","Controller/DiagramController/ComparisonToLastYearPieChartController.ts","Controller/DiagramController/YearComparisonLineChartController.ts","Controller/DiagramController/DiagramFactory.ts","Model/Feature.ts","View/DetailPage/DetailPage.tsx","View/DetailPage/ObservationStationProfile.tsx","View/DetailPage/ObservationItem.tsx","View/DetailPage/LocationMap.tsx","View/DetailPage/Diagram.tsx"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","Boolean","window","location","hostname","match","Viewport","center","zoom","this","position","useStyles","makeStyles","theme","createStyles","typography","padding","spacing","icon","background","palette","primary","main","marginBottom","box","alignItems","display","language","Language","getInstance","FeatureInfo","props","classes","React","useState","anchorEl","setAnchorEl","open","undefined","Avatar","className","aria-describedby","onClick","event","currentTarget","style","visibility","feature","Popover","onClose","anchorOrigin","vertical","horizontal","transformOrigin","Box","Typography","getDescription","getText","Button","color","variant","href","getRelatedWeblink","StationInfo","lastObservation","getObservationStation","getId","station","Grid","alignContent","direction","getName","getPosition","getString","container","item","xs","getFeature","Math","floor","getValue","getUnitOfMeasurement","openDetails","minWidth","Component","require","Map","nextViewport","lock","oldViewport","state","viewport","pin","L","IconMaterial","iconColor","markerColor","getColor","getHex","outlineColor","outlineWidth","setTimeout","newView","viewportLeafletToModel","getCenter","getDistance","abs","getZoom","updateViewport","onViewportChange","setState","Position","handlePopup","observation","polygon","getStations","obsSt","getCoordinates","v","TileLayer","attribution","url","pins","Marker","getIconFromMapPin","Popup","onOpen","polygons","positions","getPositionsFromPolygon","MapPin","value","MapConfiguration","obsStation","getScale","Polygon","stations","TestConfiguration","view","Color","random","Observation","Date","now","values","index","length","getLatestObservationMock","push","avgValue","reduce","acc","c","ObservationStation","getFeatures","getRelatedScale","features","FeatureProvider","context","definition","f","Feature","nameId","descriptionId","Scale","defaultScale","webLinkId","limit","unitOfMeasurement","diagrams","key","featureId","includes","getFeatureById","replace","json","instance","MockDataProvider","colors","randomColor","scale","toString","getLatitude","getLongitude","count","obs","i","mockStation","mockFeature","results","r","a","forEach","n","parseFloat","sqrt","radius","q","fetch","result","observations","element","Observations","Thing","Datastreams","flatMap","d","ObservedProperty","calculatePollutionIndex","name","Locations","coordinates","phenomenonTime","mockObservations","res","start","end","frequency","middle","query","console","log","gOSsPromise","response","isNullOrUndefined","description","NearConfiguration","selectedFeature","min","apply","p","max","sc","val","getLimit","getLatestObservations","buildNearScale","buildMapPin","PolygonConfiguration","getRadius","vertices","Delaunay","Point","tris","triangulate","polys","triangle","s1","p1","x","y","s2","p2","s3","p3","StationConfiguration","latestObs","DEFAULT_CONF","DEFAULT_VIEWPORT","MapConfigurationMemory","conf","localStorage","setItem","JSON","stringify","type","constructor","ls","getItem","parse","obj","latitude","longitude","MapController","useMemory","config","DEFAULT_POSITION","DEFAULT_ZOOM","mcm","load","getStation","getLatestObservation","save","getPins","getPolygons","searchTerm","encodeURIComponent","updateCurrentPosition","lat","lon","setCenter","root","formControl","margin","FeatureSelect","setOpen","listAllFeatures","setFeature","setConfig","useEffect","startConf","changeConfig","testConf","onConfigurationChange","nearConf","polyConf","stationConf","Card","CardContent","FormControl","InputLabel","Select","onChange","target","MenuItem","Search","locationEnabled","navigator","permissions","then","status","geolocation","getCurrentPosition","coords","updatePosition","err","Paper","TextField","input","label","onKeyPress","onSearch","IconButton","locationClick","iconButton","Divider","orientation","divider","disabled","withStyles","width","maxWidth","marginLeft","flex","height","backgroundColor","getStyleFromScale","grad","slice","Legend","border","MapPage","mapController","selectedStation","getViewport","update","pinPromise","polyPromsie","Promise","all","pinPoly","sortedPins","sort","b","dis","disSum","temp","handleViewportChange","promise","changePopupStation","term","search","isFinite","getMin","getMax","pos","onStationSelected","getFeatureSelectConf","zIndex","bottom","right","ErrorPage","message","AboutPage","PrivacyPolicyPage","LanguageMenu","availableLanguages","ref","selectedLang","getSelectedLanguage","handleClick","bind","handleClose","getAvailabeleLanguages","lang","changeLanguage","reload","list","handleMenuItemClick","selected","getSelectedLanguageId","startIcon","Translate","endIcon","ExpandMore","aria-controls","aria-haspopup","langList","PageMenu","toogleDrawer","toogle","AppBar","Toolbar","component","Link","to","textDecoration","float","SwipeableDrawer","anchor","List","ListItem","button","ListItemIcon","ListItemText","Layout","exact","path","DetailPage","createMuiTheme","lightGreen","secondary","purple","ReactDOM","render","StrictMode","ThemeProvider","document","getElementById","serviceWorker","ready","registration","unregister","catch","error","pow","lng","round","selectedLangId","languages","languageData","text","strings","languageID","find","langs","set","languageInstance","local","g","TypeError","toHex","hex","toUpperCase","exec","parseInt","observationStation","timestamp","availableFeatures","diagramController","getDiagramController","contr","found","counter","date","Array","valueOf","getFullYear","getMonth","getDate","getHours","linearTransition","dict","sortOnKeys","getColorFromHex","Number","getLinearTransition","numKeys","tempDict","lowerIndex","colorA","getRGB","colorB","resR","interpolate","resG","resB","add","ChartType","Timespan","FHLCConfigurationOption","timespan","xAxis","FeatureHistoryLineChartController","yAxisLabel","chartType","graphicsOptions","isConfigutable","defaultConfigurationOption","configurationOptions","option","configurationOptionName","configurationOption","getFHLCConfigurationOption","getStart","getObservations","data","getTimeStamp","options","LINE_CHART","ComparisonToLastYearPieChartController","isConfigurable","configuration","getCTLYPCConfigurationOption","lastObservationValue","pop","higher","lower","PIE_CHART","YCLCCConfigurationOption","numberOfYears","YearComparisonLineChartController","getYCLCCConfigurationOption","cleanedObservations","filter","years","header","year","splice","dt","DataTable","addValue","dtAsArray","toArray","hAxis","format","gridlines","DTRow","numberOfValues","arrayRepresentation","dtrowA","dtrowB","rows","columnKey","rowIndex","getRowIndex","getBaseDate","columnIndex","getColumnIndex","datesAreEqual","BASE_YEAR","getMinutes","getSeconds","getMilliseconds","dateA","dateB","row","DiagramFactory","diagramMap","has","get","call","relatedWeblinkId","controllerIds","iconName","controller","styles","main_container","paddingTop","xl","lg","md","sm","justify","only","renderDiagrams","ObservationStationProfile","section_1","section_2","feature_container","marginTop","latestObservations","randomNumber","getRandomColor","month","day","getDay","hour","minute","getDateString","strParameters","num","str","align","renderObservationDate","renderLatestObservations","ObservationItem","feature_card","card_content","faThermometerHalf","LocationMap","Leaflet","LatLng","ZOOM_LEVEL","scrollWheelZoom","dragging","keyboard","doubleClickZoom","TILE_SERVER","TILE_SERVER_ATTRIBUTION","MARKER_ICON","MARKER_ICON_PATH","MARKER_ICON_SIZE","Icon","iconUrl","iconSize","iconAnchor","Diagram","paddingLeft","diagram","getDefaultConfigurationOption","handleConfigurationChange","getConfigurationOptions","renderConfigurationOptions","renderDiagramConfiguration","getChartType","getGraphicsOptions","loader","getData"],"mappings":"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","file":"static/js/main.def4b4f2.chunk.js","sourcesContent":["var map = {\n\t\"./MockFeature\": 109,\n\t\"./MockFeature.json\": 109,\n\t\"./TestFeature\": 110,\n\t\"./TestFeature.json\": 110,\n\t\"./saqnopmcpm2p5\": 111,\n\t\"./saqnopmcpm2p5.json\": 111,\n\t\"./saqnopncpm10\": 112,\n\t\"./saqnopncpm10.json\": 112,\n\t\"./saqnopplev\": 113,\n\t\"./saqnopplev.json\": 113,\n\t\"./saqnopta\": 114,\n\t\"./saqnopta.json\": 114\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 168;","var map = {\n\t\"./DetailPage\": 72,\n\t\"./DetailPage.tsx\": 72,\n\t\"./Diagram\": 76,\n\t\"./Diagram.tsx\": 76,\n\t\"./LocationMap\": 75,\n\t\"./LocationMap.tsx\": 75,\n\t\"./ObservationItem\": 74,\n\t\"./ObservationItem.tsx\": 74,\n\t\"./ObservationStationProfile\": 73,\n\t\"./ObservationStationProfile.tsx\": 73,\n\t\"./marker_icon.svg\": 179\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 178;","module.exports = __webpack_public_path__ + \"static/media/marker_icon.5891ef15.svg\";","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { Position } from \"../Model/Position\";\n\nexport class Viewport {\n    private center: Position;\n    private zoom: number;\n\n    constructor(center: Position, zoom: number) {\n        this.center = center;\n        this.zoom = zoom;\n        if (this.zoom < 0) {\n            this.zoom = 0;\n        }\n    }\n\n    getCenter(): Position {\n        return this.center;\n    }\n\n    getZoom(): number {\n        return this.zoom;\n    }\n\n    getRadius(): number {\n        return this.zoom; //TODO: fix this\n    }\n\n    setCenter(position: Position) {\n        this.center = position;\n    }\n\n    setZoom(zoom: number) {\n        this.zoom = zoom;\n        if (this.zoom < 0) {\n            this.zoom = 0;\n        }\n    }\n}\n","import React from \"react\";\r\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { Avatar, Button, Box } from \"@material-ui/core\";\r\nimport InfoIcon from \"@material-ui/icons/InfoRounded\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport Language from \"../../Controller/Storage/Language\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        typography: {\r\n            padding: theme.spacing(2),\r\n        },\r\n        icon: {\r\n            background: theme.palette.primary.main,\r\n            marginBottom: \"10px\",\r\n        },\r\n        box: {\r\n            alignItems: \"center\",\r\n            display: \"flex\",\r\n            padding: \"1px\",\r\n        },\r\n    })\r\n);\r\n\r\nlet language = Language.getInstance();\r\nconst LINK_BUTTON = \"RelatedLink\";\r\n\r\ninterface IProps {\r\n    feature: Feature | null | undefined;\r\n}\r\n\r\nexport default function FeatureInfo(props: IProps) {\r\n    const classes = useStyles();\r\n    const [anchorEl, setAnchorEl] = React.useState<HTMLImageElement | null>(\r\n        null\r\n    );\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLImageElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const open = Boolean(anchorEl);\r\n    const id = open ? \"simple-popover\" : undefined;\r\n\r\n    return (\r\n        <div>\r\n            <Avatar\r\n                className={classes.icon}\r\n                aria-describedby={id}\r\n                onClick={handleClick}\r\n                style={{ visibility: props.feature ? \"visible\" : \"hidden\" }}\r\n            >\r\n                <InfoIcon />\r\n            </Avatar>\r\n            <Popover\r\n                id={id}\r\n                open={open}\r\n                anchorEl={anchorEl}\r\n                onClose={handleClose}\r\n                anchorOrigin={{\r\n                    vertical: \"bottom\",\r\n                    horizontal: \"center\",\r\n                }}\r\n                transformOrigin={{\r\n                    vertical: \"top\",\r\n                    horizontal: \"center\",\r\n                }}\r\n            >\r\n                <Box className={classes.box}>\r\n                    <Typography className={classes.typography}>\r\n                        {props.feature?.getDescription() ??\r\n                            language.getText(\"error\")}\r\n                    </Typography>\r\n                    <Button\r\n                        color=\"secondary\"\r\n                        variant=\"outlined\"\r\n                        href={\r\n                            props.feature?.getRelatedWeblink() ??\r\n                            language.getText(\"error\")\r\n                        }\r\n                    >\r\n                        {language.getText(LINK_BUTTON)}\r\n                    </Button>\r\n                </Box>\r\n            </Popover>\r\n        </div>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport { Button, Typography, Grid } from \"@material-ui/core\";\r\nimport Language from \"../../Controller/Storage/Language\";\r\nimport FeatureInfo from \"./FeatureInfo\";\r\n\r\nlet language: Language = Language.getInstance();\r\n\r\ninterface State {}\r\ninterface Props {\r\n    lastObservation: Observation;\r\n}\r\n\r\nconst DETAIL_PATH = \"/pse-airquality-react/detail/\";\r\n\r\nexport class StationInfo extends React.Component<Props, State> {\r\n    openDetails() {\r\n        window.location.href =\r\n            DETAIL_PATH +\r\n            this.props.lastObservation.getObservationStation().getId();\r\n    }\r\n\r\n    render() {\r\n        var station = this.props.lastObservation.getObservationStation();\r\n        return (\r\n            <Grid alignContent=\"center\" direction=\"column\" spacing={5}>\r\n                <Typography variant=\"h4\" color=\"secondary\">\r\n                    {station.getName()}\r\n                </Typography>\r\n                <Typography variant=\"subtitle1\" color=\"textSecondary\">\r\n                    {station.getPosition().getString()}\r\n                </Typography>\r\n                <Typography variant=\"h6\">\r\n                    <Grid container direction=\"row\" spacing={2}>\r\n                        <Grid item xs>\r\n                            {this.props.lastObservation.getFeature().getName() +\r\n                                \":\"}\r\n                        </Grid>\r\n                        <Grid item xs>\r\n                            <Typography\r\n                                variant=\"h6\"\r\n                                display=\"inline\"\r\n                                color=\"primary\"\r\n                            >\r\n                                {Math.floor(\r\n                                    this.props.lastObservation.getValue() * 100\r\n                                ) / 100}{\" \"}\r\n                                {this.props.lastObservation\r\n                                    .getFeature()\r\n                                    .getUnitOfMeasurement()}\r\n                            </Typography>\r\n                        </Grid>\r\n                    </Grid>\r\n                </Typography>\r\n                <FeatureInfo\r\n                    feature={this.props.lastObservation.getFeature()}\r\n                />\r\n                <Button\r\n                    onClick={() => this.openDetails()}\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    style={{ minWidth: \"300px\" }}\r\n                >\r\n                    {language.getText(\"stationInfoButton\")}\r\n                </Button>\r\n            </Grid>\r\n        );\r\n    }\r\n}\r\n","import \"./Map.css\";\r\nimport React from \"react\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\n\r\nimport {\r\n    Map as LeafletMap,\r\n    TileLayer,\r\n    Marker,\r\n    Polygon as LeafletPolygon,\r\n    Viewport as LeafletViewport,\r\n    Popup,\r\n} from \"react-leaflet\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport { StationInfo } from \"./StationInfo\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport { ObservationStation } from \"../../Model/ObservationStation\";\r\nimport Language from \"../../Controller/Storage/Language\";\r\nrequire(\"leaflet-iconmaterial\");\r\n\r\nconst VIEW_UPDATE_DELAY = 500; // in ms\r\nconst DISTANCE_THRESHOLD = 0.25; // In coordinate units\r\nconst ZOOM_THRESHOLD = 1; // In leaflet zoom\r\nconst DEFAULT_ZOOM = 5;\r\ninterface State {\r\n    viewport: Viewport;\r\n    lastObservation: Observation | null;\r\n}\r\n\r\ninterface Props {\r\n    onViewportChange: (viewport: Viewport) => void;\r\n    handlePopup: (pin: MapPin) => Promise<Observation>;\r\n    viewport: Viewport;\r\n    pins: MapPin[];\r\n    polygons: Polygon[];\r\n}\r\n\r\nexport class Map extends React.Component<Props, State> {\r\n    nextViewport: LeafletViewport | null;\r\n    lock: boolean;\r\n    oldViewport: Viewport | null;\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.lock = false;\r\n        this.nextViewport = null;\r\n        this.oldViewport = null;\r\n        this.state = {\r\n            viewport: this.props.viewport,\r\n            lastObservation: null,\r\n        };\r\n    }\r\n\r\n    private getIconFromMapPin(pin: MapPin): L.Icon {\r\n        // Custom icons with colors\r\n        //TODO: Add warning if limit is reached? (requires design change)\r\n        // @ts-ignore\r\n        var icon = L.IconMaterial.icon({\r\n            icon: \"\", // Name of Material icon\r\n            iconColor: \"\", // Material icon color (could be rgba, hex, html name...)\r\n            markerColor: pin.getColor().getHex(), // Marker fill color\r\n            outlineColor: \"black\", // Marker outline color\r\n            outlineWidth: 1, // Marker outline width\r\n        });\r\n        return icon;\r\n    }\r\n\r\n    private onViewportChange(viewport: LeafletViewport) {\r\n        this.nextViewport = viewport; //Update new viewport\r\n        if (!this.lock) {\r\n            if (!this.oldViewport) {\r\n                this.oldViewport = this.state.viewport; //Set viewport of last update\r\n            }\r\n            this.lock = true; //Lock update for VIEW_UPDATE_DELAY ms\r\n            setTimeout(() => {\r\n                var newView = this.viewportLeafletToModel(\r\n                    this.nextViewport as LeafletViewport\r\n                );\r\n                this.lock = false;\r\n                if (\r\n                    this.oldViewport &&\r\n                    (newView\r\n                        .getCenter()\r\n                        .getDistance(this.oldViewport?.getCenter()) >\r\n                        DISTANCE_THRESHOLD ||\r\n                        Math.abs(\r\n                            newView.getZoom() - this.oldViewport?.getZoom()\r\n                        ) >= ZOOM_THRESHOLD)\r\n                ) {\r\n                    this.updateViewport(newView); //Only update if change has been significant\r\n                }\r\n            }, VIEW_UPDATE_DELAY);\r\n        }\r\n    }\r\n\r\n    private updateViewport(viewport: Viewport) {\r\n        this.props.onViewportChange(viewport);\r\n\r\n        this.setState({ viewport: viewport });\r\n        this.oldViewport = null;\r\n    }\r\n\r\n    private viewportLeafletToModel(viewport: LeafletViewport): Viewport {\r\n        return new Viewport(\r\n            new Position(viewport.center?.[0] ?? 0, viewport.center?.[1] ?? 0),\r\n            viewport.zoom ?? DEFAULT_ZOOM\r\n        );\r\n    }\r\n\r\n    private async handlePopup(pin: MapPin) {\r\n        var observation = await this.props.handlePopup(pin);\r\n        this.setState({ lastObservation: observation });\r\n    }\r\n\r\n    private getPositionsFromPolygon(\r\n        polygon: Polygon\r\n    ): { lat: number; lng: number }[] {\r\n        return polygon\r\n            .getStations()\r\n            .map((obsSt: ObservationStation) =>\r\n                obsSt.getPosition().getCoordinates()\r\n            );\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <LeafletMap\r\n                    center={this.state.viewport.getCenter().getCoordinates()}\r\n                    zoom={this.state.viewport.getZoom()}\r\n                    onViewportChange={(v) => this.onViewportChange(v)}\r\n                >\r\n                    <TileLayer\r\n                        attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n                        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                    />\r\n                    {this.props.pins.map((pin) => (\r\n                        <Marker\r\n                            position={pin.getPosition().getCoordinates()}\r\n                            icon={this.getIconFromMapPin(pin)}\r\n                        >\r\n                            <Popup onOpen={() => this.handlePopup(pin)}>\r\n                                {this.state.lastObservation ? (\r\n                                    <StationInfo\r\n                                        lastObservation={\r\n                                            this.state.lastObservation\r\n                                        }\r\n                                    />\r\n                                ) : (\r\n                                    <p>\r\n                                        {Language.getInstance().getText(\r\n                                            \"loading\"\r\n                                        )}\r\n                                    </p>\r\n                                )}\r\n                            </Popup>\r\n                        </Marker>\r\n                    ))}\r\n                    {this.props.polygons.map((polygon) => (\r\n                        <LeafletPolygon\r\n                            positions={this.getPositionsFromPolygon(polygon)}\r\n                            color={polygon.getColor().getHex()}\r\n                        />\r\n                    ))}\r\n                </LeafletMap>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import { Color } from \"./Color\";\nimport { Position } from \"./Position\";\n\nexport class MapPin {\n  private id: string;\n  private position: Position;\n  private value: number;\n  private color: Color;\n\n  constructor(id: string, position: Position, value: number, color: Color) {\n    this.id = id;\n    this.position = position;\n    this.value = value;\n    this.color = color;\n  }\n\n  getPosition(): Position {\n    return this.position;\n  }\n\n  setPosition(position: Position) {\n    this.position = position;\n  }\n\n  getValue(): number {\n    return this.value;\n  }\n\n  setValue(value: number) {\n    this.value = value;\n  }\n\n  getId(): string {\n    return this.id;\n  }\n\n  getColor(): Color {\n    return this.color;\n  }\n}\n","import { Viewport } from \"../../Model/Viewport\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { ObservationStation } from \"../../Model/ObservationStation\";\r\n\r\nexport default abstract class MapConfiguration {\r\n    protected buildMapPin(\r\n        obsStation: ObservationStation,\r\n        value: number\r\n    ): MapPin {\r\n        return new MapPin(\r\n            obsStation.getId(),\r\n            obsStation.getPosition(),\r\n            value,\r\n            this.getScale().getColor(value)\r\n        );\r\n    }\r\n    abstract getId(): string;\r\n    abstract async getPins(view: Viewport): Promise<MapPin[]>;\r\n    abstract async getPolygons(view: Viewport): Promise<Polygon[]>;\r\n    abstract getScale(): Scale;\r\n    abstract getFeatures(): Feature[];\r\n}\r\n","import { ObservationStation } from \"./ObservationStation\";\nimport { Color } from \"./Color\";\n\nexport class Polygon {\n    private stations: ObservationStation[];\n    private color: Color;\n    constructor(stations: ObservationStation[], color: Color) {\n        this.stations = stations;\n        this.color = color;\n    }\n    getColor(): Color {\n        return this.color;\n    }\n    setColor(color: Color) {\n        this.color = color;\n    }\n    getStations(): ObservationStation[] {\n        return this.stations;\n    }\n}\n","import MapConfiguration from \"./MapPage/MapConfiguration\";\r\nimport { Viewport } from \"../Model/Viewport\";\r\nimport { Scale } from \"../Model/Scale\";\r\nimport { MapPin } from \"../Model/MapPin\";\r\nimport { Polygon } from \"../Model/Polygon\";\r\nimport { Feature } from \"../Model/Feature\";\r\nimport { Color } from \"../Model/Color\";\r\nimport { ObservationStation } from \"../Model/ObservationStation\";\r\nimport { Position } from \"../Model/Position\";\r\nimport { Observation } from \"../Model/Observation\";\r\n\r\nexport default class TestConfiguration extends MapConfiguration {\r\n    private feature: Feature;\r\n\r\n    constructor(feature: Feature) {\r\n        super();\r\n        this.feature = feature;\r\n    }\r\n\r\n    getId(): string {\r\n        return \"TestConfiguration\";\r\n    }\r\n\r\n    async getPins(view: Viewport): Promise<MapPin[]> {\r\n        return [\r\n            new MapPin(\r\n                view.getCenter().getString(),\r\n                view.getCenter(),\r\n                10,\r\n                new Color(\r\n                    Math.random() * 255,\r\n                    Math.random() * 255,\r\n                    Math.random() * 255\r\n                )\r\n            ),\r\n        ];\r\n    }\r\n\r\n    private async getLatestObservationMock(\r\n        station: ObservationStation,\r\n        feature: Feature\r\n    ): Promise<Observation> {\r\n        return new Observation(\r\n            station,\r\n            feature,\r\n            Math.random() * 50,\r\n            new Date(Date.now())\r\n        );\r\n    }\r\n\r\n    private async getPolygonColor(polygon: Polygon): Promise<Color> {\r\n        var stations = polygon.getStations();\r\n        var values = [];\r\n        for (let index = 0; index < stations.length; index++) {\r\n            var v = await this.getLatestObservationMock(\r\n                stations[index],\r\n                this.feature\r\n            );\r\n            values.push(v.getValue());\r\n        }\r\n        var avgValue = values.reduce((acc, c) => acc + c, 0) / values.length;\r\n        return this.getScale().getColor(avgValue);\r\n    }\r\n\r\n    async getPolygons(view: Viewport): Promise<Polygon[]> {\r\n        return [\r\n            new Polygon(\r\n                [\r\n                    new ObservationStation(\r\n                        \"1\",\r\n                        \"1\",\r\n                        \"\",\r\n                        new Position(49, 8.4),\r\n                        []\r\n                    ),\r\n                    new ObservationStation(\r\n                        \"1\",\r\n                        \"1\",\r\n                        \"\",\r\n                        new Position(49, 8.5),\r\n                        []\r\n                    ),\r\n                    new ObservationStation(\r\n                        \"1\",\r\n                        \"1\",\r\n                        \"\",\r\n                        new Position(50, 8.45),\r\n                        []\r\n                    ),\r\n                ],\r\n                new Color(0, 0, 0)\r\n            ),\r\n        ];\r\n    }\r\n\r\n    getScale(): Scale {\r\n        return this.getFeatures()[0].getRelatedScale();\r\n    }\r\n\r\n    getFeatures(): Feature[] {\r\n        return [this.feature];\r\n    }\r\n\r\n    setFeatures(features: Feature[]) {\r\n        if (features.length === 0) {\r\n            return; //no elements in array\r\n        }\r\n        this.feature = features[0];\r\n    }\r\n}\r\n","import { Feature } from \"../Model/Feature\";\r\nimport { Scale } from \"../Model/Scale\";\r\n\r\nexport default class FeatureProvider {\r\n    private context: any;\r\n    private features: { [id: string]: Feature };\r\n    private static instance: FeatureProvider | null = null;\r\n\r\n    constructor() {\r\n        this.features = {};\r\n        this.context = require.context(\"../Jsons/\", true);\r\n    }\r\n\r\n    static getInstance(): FeatureProvider {\r\n        if (!this.instance) {\r\n            this.instance = new FeatureProvider();\r\n        }\r\n        return this.instance;\r\n    }\r\n\r\n    private addFeature(definition: FeatureDefinition) {\r\n        if (definition) {\r\n            var f = new Feature(\r\n                definition.id,\r\n                definition.nameId,\r\n                definition.descriptionId,\r\n                new Scale(true, definition.defaultScale),\r\n                definition.webLinkId,\r\n                definition.limit,\r\n                definition.unitOfMeasurement,\r\n                definition.diagrams,\r\n                definition.icon,\r\n            );\r\n            this.features[f.getId()] = f;\r\n        }\r\n    }\r\n\r\n    //Returns all loaded features\r\n    listAllFeatures(): Feature[] {\r\n        return Object.keys(this.features).map((key) => {\r\n            return this.features[key];\r\n        });\r\n    }\r\n\r\n    getFeature(featureId: string): Feature | undefined {\r\n        if (Object.keys(this.features).includes(featureId)) {\r\n            return this.features[featureId];\r\n        } else {\r\n            var f = this.getFeatureById(featureId);\r\n            if (f) {\r\n                //Successfully read feature json\r\n                this.features[featureId] = f;\r\n                return f;\r\n            } else {\r\n                //console.log(\"Failed to read, \" + featureId, \".\");\r\n                return undefined;\r\n            }\r\n        }\r\n    }\r\n\r\n    private getFeatureById(featureId: string): Feature | null {\r\n        featureId = featureId.replace(/:/g, \"\");\r\n        try {\r\n            var json = this.context(\"./\" + featureId + \".json\");\r\n        } catch {\r\n            return null;\r\n        }\r\n        if (!json) {\r\n            return null; //Failed to read file\r\n        }\r\n        var definition = json as FeatureDefinition;\r\n        return new Feature(\r\n            definition.id,\r\n            definition.nameId,\r\n            definition.descriptionId,\r\n            new Scale(true, definition.defaultScale),\r\n            definition.webLinkId,\r\n            definition.limit,\r\n            definition.unitOfMeasurement,\r\n            definition.diagrams,\r\n            definition.icon,\r\n        );\r\n    }\r\n}\r\n\r\ninterface FeatureDefinition {\r\n    id: string;\r\n    nameId: string;\r\n    unitOfMeasurement: string;\r\n    descriptionId: string;\r\n    defaultScale: { [key: number]: string };\r\n    webLinkId: string;\r\n    limit: number;\r\n    diagrams: string[];\r\n    icon: string;\r\n}\r\n","import { Feature } from \"../../Model/Feature\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport { ObservationStation } from \"../../Model/ObservationStation\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { Color } from \"../../Model/Color\";\r\nimport FeatureProvider from \"../FeatureProvider\";\r\nimport { isNullOrUndefined } from \"util\";\r\n\r\nconst PNC10_ID = \"saqn:op:ncpm10\";\r\n\r\nexport default class MockDataProvider {\r\n    private static stations: { [key: string]: ObservationStation } = {};\r\n    private static gOSsPromise: Promise<any>;\r\n\r\n    private static randomColor(): Color {\r\n        return new Color(\r\n            Math.random() * 255,\r\n            Math.random() * 255,\r\n            Math.random() * 255\r\n        );\r\n    }\r\n    static mockFeature(): Feature {\r\n        var colors: { [key: number]: string } = {};\r\n        for (let index = 0; index < 5; index++) {\r\n            var c = this.randomColor().getHex();\r\n            colors[Math.floor(Math.random() * 100)] = c;\r\n        }\r\n        var scale = new Scale(true, colors);\r\n        return new Feature(\r\n            \"MockFeature\",\r\n            \"nameId\",\r\n            \"descId\",\r\n            scale,\r\n            \"weblink\",\r\n            100,\r\n            \"uoM\",\r\n            [],\r\n            \"icon\"\r\n        );\r\n    }\r\n    private static mockStation(center: Position): ObservationStation {\r\n        var id = Math.floor(Math.random() * 10000).toString();\r\n        var station = new ObservationStation(\r\n            id,\r\n            \"mockName\",\r\n            \"mockDesc\",\r\n            new Position(\r\n                center.getLatitude() + 6 * Math.random() - 3,\r\n                center.getLongitude() + 6 * Math.random() - 3\r\n            ),\r\n            []\r\n        );\r\n        MockDataProvider.stations[station.getId()] = station;\r\n        return station;\r\n    }\r\n    private static mockObservations(center: Position): Observation[] {\r\n        var count = Math.floor(Math.random() * 9) + 2;\r\n        var obs = [];\r\n        for (let i = 0; i < count; i++) {\r\n            obs.push(\r\n                new Observation(\r\n                    this.mockStation(center),\r\n                    this.mockFeature(),\r\n                    Math.random() * 100,\r\n                    new Date(Date.now())\r\n                )\r\n            );\r\n        }\r\n        return obs;\r\n    }\r\n\r\n    private static calculatePollutionIndex(results: {\r\n        [key: string]: string;\r\n    }): number {\r\n        if (Object.keys(results).length === 0) {\r\n            return 0;\r\n        }\r\n\r\n        var r = Object.values(results);\r\n\r\n        var a = 0;\r\n        r.forEach((n) => (a += parseFloat(n)));\r\n        return Math.sqrt(a) / r.length;\r\n    }\r\n\r\n    static async getLatestObservations(\r\n        center: Position,\r\n        radius: number,\r\n        feature: Feature\r\n    ): Promise<Observation[]> {\r\n        var q =\r\n            \"https://api.smartaq.net/v1.0/Datastreams?\" +\r\n            \"$select=@iot.id,name\" +\r\n            \"&$filter=geo.distance(Thing/Locations/location,geography'POINT({lon} {lat})') lt {radius} and \" +\r\n            \"overlaps(phenomenonTime,(now() sub duration'P1d')) and \" +\r\n            \"ObservedProperty/@iot.id eq '{featureId}'\" +\r\n            \"&$expand=Thing($select=name,@iot.id;$expand=Locations($select=location),\" +\r\n            \"Datastreams($select=name)/ObservedProperty($select=@iot.id)),\" +\r\n            \"Observations($select=result,phenomenonTime;$filter=\" +\r\n            \"phenomenonTime gt now() sub duration'P1D';$orderby=phenomenonTime desc;$top=1\" +\r\n            \")\";\r\n        q = q\r\n            .replace(/{lon}/g, center.getLongitude().toString())\r\n            .replace(/{lat}/g, center.getLatitude().toString())\r\n            .replace(/{radius}/g, radius.toString())\r\n            .replace(/{featureId}/g, feature.getId());\r\n        var json = await (await fetch(q)).json();\r\n        var result: IGetLatestObs[] = json.value;\r\n        var observations: Observation[] = [];\r\n        result.forEach((element) => {\r\n            if (element.Observations.length !== 0) {\r\n                var features: Feature[] = element.Thing.Datastreams.flatMap(\r\n                    (d) => {\r\n                        var f = FeatureProvider.getInstance().getFeature(\r\n                            d.ObservedProperty[\"@iot.id\"]\r\n                        );\r\n                        return f ?? [];\r\n                    }\r\n                );\r\n                if (feature.getId() === PNC10_ID) {\r\n                    element.Observations[0].result = this.calculatePollutionIndex(\r\n                        element.Observations[0].result as {\r\n                            [key: string]: string;\r\n                        }\r\n                    );\r\n                }\r\n\r\n                var o = new Observation(\r\n                    new ObservationStation(\r\n                        element.Thing[\"@iot.id\"],\r\n                        element.Thing.name,\r\n                        element.Thing[\"@iot.id\"] + \"_desc\",\r\n                        new Position(\r\n                            element.Thing.Locations[0].location.coordinates[1],\r\n                            element.Thing.Locations[0].location.coordinates[0]\r\n                        ),\r\n                        features\r\n                    ),\r\n                    feature,\r\n                    (element.Observations[0].result as number) ?? -1,\r\n                    new Date(element.Observations[0].phenomenonTime)\r\n                );\r\n                observations.push(o);\r\n                MockDataProvider.stations[\r\n                    o.getObservationStation().getId()\r\n                ] = o.getObservationStation();\r\n            }\r\n        });\r\n\r\n        return observations;\r\n    }\r\n\r\n    static async getLatestObservation(\r\n        station: ObservationStation,\r\n        feature: Feature\r\n    ): Promise<Observation> {\r\n        if (feature.getId() === \"MockFeature\") {\r\n            return this.mockObservations(station.getPosition())[0];\r\n        }\r\n        var q =\r\n            \"https://api.smartaq.net/v1.0/Datastreams?\" +\r\n            \"$select=@iot.id\" +\r\n            \"&$filter=Thing/@iot.id eq '{stationId}' and \" +\r\n            \"ObservedProperty/@iot.id eq '{featureId}'\" +\r\n            \"&$expand=Observations(\" +\r\n            \"$top=1;$orderby=phenomenonTime desc;$select=result,phenomenonTime)\";\r\n        q = q\r\n            .replace(/{featureId}/g, feature.getId())\r\n            .replace(/{stationId}/g, station.getId());\r\n        var res: IGetLatestObservation[] = (await (await fetch(q)).json())\r\n            .value;\r\n        //console.log(res);\r\n        if (!res || res.length === 0) {\r\n            return new Observation(station, feature, -1, new Date(Date.now()));\r\n        }\r\n        if (feature.getId() === PNC10_ID) {\r\n            res[0].Observations[0].result = this.calculatePollutionIndex(\r\n                res[0].Observations[0].result as {\r\n                    [key: string]: string;\r\n                }\r\n            );\r\n        }\r\n        return new Observation(\r\n            station,\r\n            feature,\r\n            res[0].Observations[0].result as number,\r\n            new Date(res[0].Observations[0].phenomenonTime)\r\n        );\r\n    }\r\n\r\n    static getObservations(\r\n        station: ObservationStation,\r\n        start: Date,\r\n        end: Date,\r\n        feature: Feature,\r\n        frequency?: Date\r\n    ): Observation[] {\r\n        throw new Error(\"Not implemented\");\r\n    }\r\n\r\n    static async getObservationStations(\r\n        middle: Position,\r\n        radius: number\r\n    ): Promise<ObservationStation[]> {\r\n        var query =\r\n            \"https://api.smartaq.net/v1.0/Things?\" +\r\n            \"$filter=geo.distance(Locations/location,geography'POINT({lon} {lat})') \" +\r\n            \"lt {radius} \" +\r\n            \"and overlaps(Datastreams/phenomenonTime,(now() sub duration'P1d'))\" +\r\n            \"&$expand=Locations($select=location),\" +\r\n            \"Datastreams($select=name)/ObservedProperty($select=@iot.id)\";\r\n        console.log(\r\n            query\r\n                .replace(/{lon}/g, middle.getLongitude().toString())\r\n                .replace(/{lat}/g, middle.getLatitude().toString())\r\n                .replace(/{radius}/g, radius.toString())\r\n        );\r\n        MockDataProvider.gOSsPromise = fetch(\r\n            query\r\n                .replace(/{lon}/g, middle.getLongitude().toString())\r\n                .replace(/{lat}/g, middle.getLatitude().toString())\r\n                .replace(/{radius}/g, radius.toString())\r\n        );\r\n        var response = await (await MockDataProvider.gOSsPromise).json();\r\n        var obs: ObservationStation[] = [];\r\n        response.value.forEach((element: IGetObservationStations) => {\r\n            var features: Feature[] = element.Datastreams.flatMap((d) => {\r\n                var f = FeatureProvider.getInstance().getFeature(\r\n                    d.ObservedProperty[\"@iot.id\"]\r\n                );\r\n                if (!isNullOrUndefined(f)) {\r\n                    return f as Feature;\r\n                } else {\r\n                    return [];\r\n                }\r\n            });\r\n            var o = new ObservationStation(\r\n                element[\"@iot.id\"],\r\n                element.name,\r\n                element.description,\r\n                new Position(\r\n                    element.Locations[0].location.coordinates[1],\r\n                    element.Locations[0].location.coordinates[0]\r\n                ),\r\n                features\r\n            );\r\n            obs.push(o);\r\n            MockDataProvider.stations[o.getId()] = o;\r\n        });\r\n        return obs;\r\n    }\r\n\r\n    static getStation(id: string): ObservationStation {\r\n        return MockDataProvider.stations[id];\r\n    }\r\n}\r\n\r\ninterface IGetObservationStations {\r\n    \"@iot.id\": string;\r\n    name: string;\r\n    description: string;\r\n    Locations: [\r\n        {\r\n            location: {\r\n                coordinates: [number, number, number];\r\n            };\r\n        }\r\n    ];\r\n    Datastreams: {\r\n        ObservedProperty: {\r\n            \"@iot.id\": string;\r\n        };\r\n    }[];\r\n}\r\n\r\ninterface IGetLatestObservation {\r\n    Observations: [\r\n        {\r\n            phenomenonTime: string;\r\n            result: number | { [key: string]: string };\r\n        }\r\n    ];\r\n}\r\n\r\ninterface IGetLatestObs {\r\n    \"@iot.id\": string;\r\n    Thing: {\r\n        \"@iot.id\": string;\r\n        Locations: [\r\n            {\r\n                location: {\r\n                    coordinates: [number, number];\r\n                };\r\n            }\r\n        ];\r\n        name: string;\r\n        Datastreams: {\r\n            ObservedProperty: {\r\n                \"@iot.id\": string;\r\n            };\r\n        }[];\r\n    };\r\n    Observations: {\r\n        result: number | { [key: string]: string };\r\n        phenomenonTime: string;\r\n    }[];\r\n}\r\n","import MapConfiguration from \"./MapConfiguration\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport MockDataProvider from \"../FROST/MockDataProvider\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport { ObservationStation } from \"../../Model/ObservationStation\";\r\n\r\nconst SAMPLE_SCALE = 20;\r\nconst ID = \"NearConfiguration\";\r\n\r\nexport default class NearConfiguration extends MapConfiguration {\r\n    private selectedFeature: Feature;\r\n    private scale: Scale;\r\n\r\n    constructor(feature: Feature) {\r\n        super();\r\n        this.selectedFeature = feature;\r\n        this.scale = this.selectedFeature.getRelatedScale();\r\n    }\r\n\r\n    getId(): string {\r\n        return ID;\r\n    }\r\n\r\n    buildMapPin(obs: ObservationStation, value: number): MapPin {\r\n        return new MapPin(\r\n            obs.getId(),\r\n            obs.getPosition(),\r\n            value,\r\n            this.scale.getColor(value)\r\n        );\r\n    }\r\n\r\n    private buildNearScale(observations: Observation[]): Scale {\r\n        var min = Math.min.apply(\r\n            Math,\r\n            observations.map((p) => {\r\n                return p.getValue();\r\n            })\r\n        );\r\n        var max = Math.max.apply(\r\n            Math,\r\n            observations.map((p) => {\r\n                return p.getValue();\r\n            })\r\n        );\r\n\r\n        var sc: { [key: number]: string } = {};\r\n        // Sample 10 times between 0 => min and limit of feature => max\r\n        for (let index = 0; index < SAMPLE_SCALE; index++) {\r\n            var key = Math.floor(min + (max - min) * (index / SAMPLE_SCALE));\r\n            var val = this.selectedFeature.getLimit() * (index / SAMPLE_SCALE);\r\n            sc[key] = this.selectedFeature\r\n                .getRelatedScale()\r\n                .getColor(val)\r\n                .getHex();\r\n        }\r\n        return new Scale(true, sc);\r\n    }\r\n\r\n    async getPins(view: Viewport): Promise<MapPin[]> {\r\n        var observations = await MockDataProvider.getLatestObservations(\r\n            view.getCenter(),\r\n            view.getZoom(),\r\n            this.selectedFeature\r\n        );\r\n\r\n        this.scale = this.buildNearScale(observations);\r\n\r\n        var pins: MapPin[] = [];\r\n        observations.forEach((o) => {\r\n            pins.push(\r\n                this.buildMapPin(o.getObservationStation(), o.getValue())\r\n            );\r\n        });\r\n        return pins;\r\n    }\r\n\r\n    async getPolygons(view: Viewport): Promise<Polygon[]> {\r\n        return [];\r\n    }\r\n    getScale(): Scale {\r\n        return this.scale;\r\n    }\r\n    getFeatures(): Feature[] {\r\n        return [this.selectedFeature];\r\n    }\r\n}\r\n","import MapConfiguration from \"./MapConfiguration\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport MockDataProvider from \"../FROST/MockDataProvider\";\r\n//@ts-ignore\r\nimport Delaunay from \"delaunay-triangulation\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport { Observation } from \"../../Model/Observation\";\r\n\r\nconst ID = \"PolygonConfiguration\";\r\nexport default class PolygonConfiguration extends MapConfiguration {\r\n    getId(): string {\r\n        return ID;\r\n    }\r\n    private selectedFeature: Feature;\r\n\r\n    constructor(feature: Feature) {\r\n        super();\r\n        this.selectedFeature = feature;\r\n    }\r\n\r\n    async getPins(view: Viewport): Promise<MapPin[]> {\r\n        return [];\r\n    }\r\n\r\n    async getPolygons(view: Viewport): Promise<Polygon[]> {\r\n        var observations = await MockDataProvider.getLatestObservations(\r\n            view.getCenter(),\r\n            view.getRadius(),\r\n            this.selectedFeature\r\n        );\r\n        var stations: {\r\n            [key: string]: Observation;\r\n        } = {};\r\n        var vertices: Delaunay.Point[] = [];\r\n\r\n        for (let index = 0; index < observations.length; index++) {\r\n            stations[\r\n                observations[index]\r\n                    .getObservationStation()\r\n                    .getPosition()\r\n                    .getString()\r\n            ] = observations[index];\r\n            vertices.push(\r\n                new Delaunay.Point(\r\n                    observations[index]\r\n                        .getObservationStation()\r\n                        .getPosition()\r\n                        .getLatitude(),\r\n                    observations[index]\r\n                        .getObservationStation()\r\n                        .getPosition()\r\n                        .getLongitude()\r\n                )\r\n            );\r\n        }\r\n\r\n        var tris = Delaunay.triangulate(vertices);\r\n        var polys: Polygon[] = [];\r\n        tris.forEach((triangle: any) => {\r\n            var s1 =\r\n                stations[\r\n                    new Position(triangle.p1.x, triangle.p1.y).getString()\r\n                ];\r\n            var s2 =\r\n                stations[\r\n                    new Position(triangle.p2.x, triangle.p2.y).getString()\r\n                ];\r\n            var s3 =\r\n                stations[\r\n                    new Position(triangle.p3.x, triangle.p3.y).getString()\r\n                ];\r\n            var avgValue = (s1.getValue() + s2.getValue() + s3.getValue()) / 3;\r\n            polys.push(\r\n                new Polygon(\r\n                    [\r\n                        s1.getObservationStation(),\r\n                        s2.getObservationStation(),\r\n                        s3.getObservationStation(),\r\n                    ],\r\n                    this.getScale().getColor(avgValue)\r\n                )\r\n            );\r\n        });\r\n\r\n        return polys;\r\n    }\r\n\r\n    getScale(): Scale {\r\n        return this.selectedFeature.getRelatedScale();\r\n    }\r\n\r\n    getFeatures(): Feature[] {\r\n        return [this.selectedFeature];\r\n    }\r\n}\r\n","import MapConfiguration from \"./MapConfiguration\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport MockDataProvider from \"../FROST/MockDataProvider\";\r\nimport { Feature } from \"../../Model/Feature\";\r\n\r\nconst ID = \"StationConfiguration\";\r\n\r\nexport default class StationConfiguration extends MapConfiguration {\r\n    getId(): string {\r\n        return ID;\r\n    }\r\n    private selectedFeature: Feature;\r\n\r\n    constructor(feature: Feature) {\r\n        super();\r\n        this.selectedFeature = feature;\r\n    }\r\n\r\n    async getPins(view: Viewport): Promise<MapPin[]> {\r\n        var latestObs = await MockDataProvider.getLatestObservations(\r\n            view.getCenter(),\r\n            view.getZoom(),\r\n            this.selectedFeature\r\n        );\r\n        return latestObs.map((o) =>\r\n            this.buildMapPin(o.getObservationStation(), o.getValue())\r\n        );\r\n    }\r\n\r\n    async getPolygons(view: Viewport): Promise<Polygon[]> {\r\n        return [];\r\n    }\r\n\r\n    getScale(): Scale {\r\n        return this.selectedFeature.getRelatedScale();\r\n    }\r\n\r\n    getFeatures(): Feature[] {\r\n        return [this.selectedFeature];\r\n    }\r\n}\r\n","import MapConfiguration from \"../MapPage/MapConfiguration\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport TestConfiguration from \"../TestConfiguration\";\r\nimport NearConfiguration from \"../MapPage/NearConfiguration\";\r\nimport FeatureProvider from \"../FeatureProvider\";\r\nimport PolygonConfiguration from \"../MapPage/PolygonConfiguration\";\r\nimport StationConfiguration from \"../MapPage/StationConfiguration\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport { isNullOrUndefined } from \"util\";\r\n\r\nconst LOCALSTORAGE_MAPCONF = \"mapconf\";\r\nconst DEFAULT_CONF = new StationConfiguration(\r\n    FeatureProvider.getInstance().getFeature(\"saqn:op:ta\") as Feature\r\n);\r\nconst DEFAULT_VIEWPORT = new Viewport(new Position(49, 8.4), 7);\r\n\r\nexport default class MapConfigurationMemory {\r\n    static save(conf: MapConfiguration, view: Viewport) {\r\n        localStorage.setItem(\r\n            LOCALSTORAGE_MAPCONF,\r\n            JSON.stringify({\r\n                type: conf.constructor.name,\r\n                feature: conf.getFeatures()[0].getId(),\r\n                view: view,\r\n            })\r\n        );\r\n    }\r\n\r\n    static load(): [MapConfiguration, Viewport] {\r\n        var ls = localStorage.getItem(LOCALSTORAGE_MAPCONF);\r\n        if (\r\n            ls &&\r\n            (JSON.parse(ls) as {\r\n                type: string;\r\n                feature: string;\r\n                view: Viewport;\r\n            })\r\n        ) {\r\n            //return configuration if it exists\r\n            var obj = JSON.parse(ls) as {\r\n                type: string;\r\n                feature: string;\r\n                view: any;\r\n            };\r\n            var view = new Viewport(\r\n                new Position(\r\n                    obj.view.center.latitude,\r\n                    obj.view.center.longitude\r\n                ),\r\n                obj.view.zoom\r\n            );\r\n            var feature = FeatureProvider.getInstance().getFeature(obj.feature);\r\n            if (isNullOrUndefined(feature)) {\r\n                throw new Error(\r\n                    \"Feature \" + obj.feature + \" is not supported.\"\r\n                );\r\n            }\r\n            if (obj.type === \"NearConfiguration\") {\r\n                return [new NearConfiguration(feature), view];\r\n            } else if (obj.type === \"PolygonConfiguration\") {\r\n                return [new PolygonConfiguration(feature), view];\r\n            } else if (obj.type === \"StationConfiguration\") {\r\n                return [new StationConfiguration(feature), view];\r\n            } else {\r\n                return [new TestConfiguration(feature), view];\r\n            }\r\n        }\r\n        return [DEFAULT_CONF, DEFAULT_VIEWPORT];\r\n    }\r\n}\r\n","import { Viewport } from \"../../Model/Viewport\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport { Scale } from \"../../Model/Scale\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport MapConfiguration from \"./MapConfiguration\";\r\nimport MapConfigurationMemory from \"../Storage/MapConfigurationMemory\";\r\nimport MockDataProvider from \"../FROST/MockDataProvider\";\r\nimport StationConfiguration from \"./StationConfiguration\";\r\nimport FeatureProvider from \"../FeatureProvider\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\n\r\nexport class MapController {\r\n    private config: MapConfiguration;\r\n    private viewport: Viewport;\r\n\r\n    private DEFAULT_POSITION: Position = new Position(49, 8.4);\r\n    private DEFAULT_ZOOM: number = 5;\r\n\r\n    constructor(useMemory: boolean = true) {\r\n        if (useMemory) {\r\n            var mcm = MapConfigurationMemory.load();\r\n            this.config = mcm[0];\r\n            this.viewport = mcm[1];\r\n        } else {\r\n            this.viewport = new Viewport(\r\n                this.DEFAULT_POSITION,\r\n                this.DEFAULT_ZOOM\r\n            );\r\n            this.config = new StationConfiguration(\r\n                FeatureProvider.getInstance().getFeature(\r\n                    \"saqn:op:mcpm2p5\"\r\n                ) as Feature\r\n            );\r\n        }\r\n        if (this.config.getFeatures().length === 0) {\r\n            throw Error(\"Invalid MapConfiguration\");\r\n        }\r\n    }\r\n\r\n    async handlePopup(pin: MapPin): Promise<Observation> {\r\n        var station = await MockDataProvider.getStation(pin.getId());\r\n        return MockDataProvider.getLatestObservation(\r\n            station,\r\n            this.config.getFeatures()[0]\r\n        );\r\n    }\r\n\r\n    private save() {\r\n        MapConfigurationMemory.save(this.config, this.viewport);\r\n    }\r\n\r\n    /** \r\n    private configType(conf : any) : string {\r\n        switch (conf.constructor.name) {\r\n            case \"PolygonConfigutr\":\r\n                \r\n                break;\r\n        \r\n            default:\r\n                throw new Error(\"Could not find configuration.\")\r\n                break;\r\n        }\r\n    }*/\r\n\r\n    getFeatureSelectConf(): { conf: string; feature: string } {\r\n        var f = this.config.getFeatures()[0].getId();\r\n        var c = this.config.getId();\r\n        return { conf: c, feature: f };\r\n    }\r\n\r\n    getViewport(): Viewport {\r\n        return this.viewport;\r\n    }\r\n\r\n    handleViewportChange(viewport: Viewport) {\r\n        this.viewport = viewport;\r\n        this.save();\r\n    }\r\n\r\n    async getPins(): Promise<MapPin[]> {\r\n        return this.config.getPins(this.viewport);\r\n    }\r\n\r\n    async getPolygons(): Promise<Polygon[]> {\r\n        return this.config.getPolygons(this.viewport);\r\n    }\r\n\r\n    getScale(): Scale {\r\n        return this.config.getScale();\r\n    }\r\n\r\n    changeFeature(feature: Feature) {\r\n        //TODO\r\n    }\r\n\r\n    onConfigurationChange(conf: MapConfiguration) {\r\n        this.config = conf;\r\n        this.save();\r\n    }\r\n\r\n    async search(searchTerm: string) {\r\n        if (searchTerm.length === 0) {\r\n            return; //No search possible\r\n        }\r\n\r\n        var response = await fetch(\r\n            \"https://nominatim.openstreetmap.org/search?format=json&q=\" +\r\n                encodeURIComponent(searchTerm)\r\n        );\r\n        var json = await response.json();\r\n        if (json.length === 0) {\r\n            return; //No location found\r\n        }\r\n        this.updateCurrentPosition(new Position(json[0].lat, json[0].lon));\r\n    }\r\n\r\n    updateCurrentPosition(position: Position) {\r\n        this.viewport.setCenter(position);\r\n        console.log(position);\r\n    }\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n    Avatar,\r\n    Card,\r\n    CardContent,\r\n    FormControl,\r\n    InputLabel,\r\n    Select,\r\n    MenuItem,\r\n} from \"@material-ui/core\";\r\nimport LayersIcon from \"@material-ui/icons/Layers\";\r\nimport { createStyles, Theme, makeStyles } from \"@material-ui/core/styles\";\r\nimport MapConfiguration from \"../../Controller/MapPage/MapConfiguration\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport TestConfiguration from \"../../Controller/TestConfiguration\";\r\nimport NearConfiguration from \"../../Controller/MapPage/NearConfiguration\";\r\nimport StationConfiguration from \"../../Controller/MapPage/StationConfiguration\";\r\nimport PolygonConfiguration from \"../../Controller/MapPage/PolygonConfiguration\";\r\nimport FeatureProvider from \"../../Controller/FeatureProvider\";\r\ninterface Props {\r\n    onConfigurationChange(mapConfig: MapConfiguration): void;\r\n    startConf?: { conf: string; feature: string };\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            background: theme.palette.primary.main,\r\n        },\r\n        formControl: {\r\n            margin: theme.spacing(1),\r\n            minWidth: 120,\r\n        },\r\n    })\r\n);\r\n\r\nexport default function FeatureSelect(props: Props) {\r\n    const TEST_CONFIG = \"TestConfiguration\";\r\n    const NEAR_CONFIG = \"NearConfiguration\";\r\n    const POLY_CONFIG = \"PolygonConfiguration\";\r\n    const STATION_CONFIG = \"StationConfiguration\";\r\n    const classes = useStyles();\r\n    const [open, setOpen] = useState<HTMLImageElement | null>(null);\r\n    const [feature, setFeature] = useState<Feature | undefined>(\r\n        FeatureProvider.getInstance().listAllFeatures()[0]\r\n    );\r\n    const [config, setConfig] = useState<string | null>(STATION_CONFIG);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLImageElement>) => {\r\n        setOpen(open ? null : event.currentTarget);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (props.startConf) {\r\n            //Get start values from props\r\n            setFeature(\r\n                FeatureProvider.getInstance().getFeature(\r\n                    props.startConf.feature\r\n                )\r\n            );\r\n            setConfig(props.startConf.conf);\r\n        }\r\n    }, []);\r\n    const changeConfig = (conf: string, feature: Feature) => {\r\n        console.log(conf);\r\n        setConfig(conf);\r\n        switch (conf) {\r\n            case TEST_CONFIG:\r\n                var testConf = new TestConfiguration(feature); //Create new config\r\n                props.onConfigurationChange(testConf);\r\n                break;\r\n            case NEAR_CONFIG:\r\n                var nearConf = new NearConfiguration(feature); //Create new config\r\n                props.onConfigurationChange(nearConf);\r\n                break;\r\n            case POLY_CONFIG:\r\n                var polyConf = new PolygonConfiguration(feature); //Create new config\r\n                props.onConfigurationChange(polyConf);\r\n                break;\r\n            case STATION_CONFIG:\r\n                var stationConf = new StationConfiguration(feature); //Create new config\r\n                props.onConfigurationChange(stationConf);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    const handleFeatureChange = (\r\n        event: React.ChangeEvent<{ value: unknown }>\r\n    ) => {\r\n        var f = FeatureProvider.getInstance().getFeature(\r\n            event.target.value as string\r\n        ); //Feature Id\r\n        setFeature(f);\r\n\r\n        if (f) {\r\n            if (config) {\r\n                changeConfig(config, f);\r\n            } else {\r\n                throw new Error(\"No config selected\");\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleConfigChange = (\r\n        event: React.ChangeEvent<{ value: unknown }>\r\n    ) => {\r\n        if (!feature) {\r\n            return; //A feature has to be selected, should never happen.\r\n        }\r\n        changeConfig(event.target.value as string, feature);\r\n        //window.location.reload(); //Reload with new config\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Avatar className={classes.root} onClick={handleClick}>\r\n                <LayersIcon />\r\n            </Avatar>\r\n            {open ? (\r\n                <Card variant=\"outlined\">\r\n                    <CardContent>\r\n                        <FormControl className={classes.formControl}>\r\n                            <InputLabel>{\"Feature\"}</InputLabel>\r\n                            <Select\r\n                                onChange={handleFeatureChange}\r\n                                value={feature?.getId() ?? \"\"}\r\n                            >\r\n                                {FeatureProvider.getInstance()\r\n                                    .listAllFeatures()\r\n                                    .map((f) => (\r\n                                        <MenuItem value={f.getId()}>\r\n                                            {f.getName()}\r\n                                        </MenuItem>\r\n                                    ))}\r\n                            </Select>\r\n                        </FormControl>\r\n                        <FormControl className={classes.formControl}>\r\n                            <InputLabel>{\"Style\"}</InputLabel>\r\n                            <Select\r\n                                onChange={handleConfigChange}\r\n                                value={config ?? \"\"}\r\n                            >\r\n                                <MenuItem value={POLY_CONFIG}>\r\n                                    {POLY_CONFIG}\r\n                                </MenuItem>\r\n                                <MenuItem value={STATION_CONFIG}>\r\n                                    {STATION_CONFIG}\r\n                                </MenuItem>\r\n                                <MenuItem value={NEAR_CONFIG}>\r\n                                    {NEAR_CONFIG}\r\n                                </MenuItem>\r\n                            </Select>\r\n                        </FormControl>\r\n                    </CardContent>\r\n                </Card>\r\n            ) : (\r\n                \"\"\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","import React from \"react\";\nimport {\n    TextField,\n    Paper,\n    IconButton,\n    Divider,\n    Theme,\n} from \"@material-ui/core\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport LocationIcon from \"@material-ui/icons/LocationOn\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { Position } from \"../../Model/Position\";\nimport Language from \"../../Controller/Storage/Language\";\n\nconst styles = (theme: Theme) => ({\n    root: {\n        margin: \"5px 5px\",\n        padding: \"2px 4px\",\n        display: \"flex\",\n        alignItems: \"center\",\n        width: \"100%\",\n        maxWidth: \"500px\",\n    },\n    input: {\n        marginLeft: theme.spacing(1),\n        flex: 1,\n    },\n    iconButton: {\n        padding: 10,\n    },\n    divider: {\n        height: 28,\n        margin: 4,\n    },\n});\n\nlet language = Language.getInstance();\n\ninterface Props {\n    classes: any;\n    onSearch(term: string): void;\n    updatePosition(pos: Position): void;\n}\n\ninterface State {\n    searchTerm: string;\n    locationEnabled: boolean;\n}\n\nclass Search extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = { searchTerm: \"\", locationEnabled: true };\n        if (\"geolocation\" in navigator) {\n            navigator.permissions\n                .query({ name: \"geolocation\" })\n                .then((status: PermissionStatus) => {\n                    if (status.state === \"denied\") {\n                        //If permission was denied, disable button\n                        this.setState({ locationEnabled: false });\n                    }\n                });\n        }\n    }\n\n    locationClick() {\n        if (\"geolocation\" in navigator) {\n            console.log(\"Available\");\n            navigator.geolocation.getCurrentPosition(\n                (res) => {\n                    //Get position\n                    var position = new Position(\n                        res.coords.latitude,\n                        res.coords.longitude\n                    );\n                    this.props.updatePosition(position);\n                    this.setState({ locationEnabled: true });\n                },\n                (err) => {\n                    //Location denied\n                    console.log(\"Location denied.\");\n                    this.setState({ locationEnabled: false });\n                }\n            );\n        } else {\n            //Browser doesn't support geolocation\n            console.log(\"Not Available\");\n            this.setState({ locationEnabled: false });\n        }\n    }\n\n    render() {\n        return (\n            <Paper className={this.props.classes.root}>\n                <TextField\n                    type=\"search\"\n                    variant=\"outlined\"\n                    className={this.props.classes.input}\n                    label={language.getText(\"search\")}\n                    onKeyPress={(e) => {\n                        if (e.key === \"Enter\") {\n                            this.props.onSearch(this.state.searchTerm); //Enter key was pressed, search for this.state.searchTerm\n                        }\n                    }}\n                    onChange={(e) => {\n                        this.setState({ searchTerm: e.target.value });\n                    }}\n                    value={this.state.searchTerm}\n                />\n                <IconButton\n                    onClick={() => this.locationClick()}\n                    className={this.props.classes.iconButton}\n                >\n                    <SearchIcon />\n                </IconButton>\n                <Divider\n                    orientation=\"vertical\"\n                    className={this.props.classes.divider}\n                />\n                <IconButton\n                    color=\"primary\"\n                    onClick={() => this.locationClick()}\n                    className={this.props.classes.iconButton}\n                    disabled={!this.state.locationEnabled}\n                >\n                    <LocationIcon />\n                </IconButton>\n            </Paper>\n        );\n    }\n}\n\nexport default withStyles(styles)(Search);\n","import React from \"react\";\nimport { Scale } from \"../../Model/Scale\";\nimport { Box, Grid, Typography } from \"@material-ui/core\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        box: {\n            padding: theme.spacing(1),\n            width: \"50px\",\n            backgroundColor: \"white\",\n        },\n    })\n);\n\ninterface Props {\n    scale: Scale;\n    min: number;\n    max: number;\n}\n\nfunction getStyleFromScale(scale: Scale, min: number, max: number) {\n    var grad = \"linear-gradient(0deg,\";\n    for (let index = 0; index < 10; index++) {\n        grad =\n            grad +\n            scale.getColor(min + (max - min) * (index / 10)).getHex() +\n            \" \" +\n            index * 10 +\n            \"%, \";\n    }\n    grad = grad.slice(0, -2) + \")\";\n    return {\n        background: grad,\n        height: \"80px\",\n        width: \"40px\",\n    };\n}\n\nfunction Legend(props: Props) {\n    const classes = useStyles();\n    return (\n        <Box className={classes.box} border={1}>\n            <Grid container direction=\"column\">\n                <Typography variant=\"body2\">\n                    {Math.floor(props.max * 10) / 10}\n                </Typography>\n                <Box\n                    style={getStyleFromScale(props.scale, props.min, props.max)}\n                />\n                <Typography variant=\"body2\">\n                    {Math.floor(props.min * 10) / 10}\n                </Typography>\n            </Grid>\n        </Box>\n    );\n}\n\nexport default Legend;\n","import React from \"react\";\r\nimport { ObservationStation } from \"../../Model/ObservationStation\";\r\nimport { Map } from \"./Map\";\r\nimport { Feature } from \"../../Model/Feature\";\r\nimport { Viewport } from \"../../Model/Viewport\";\r\nimport { MapController } from \"../../Controller/MapPage/MapController\";\r\nimport { MapPin } from \"../../Model/MapPin\";\r\nimport { Polygon } from \"../../Model/Polygon\";\r\nimport { Position } from \"../../Model/Position\";\r\nimport { Observation } from \"../../Model/Observation\";\r\nimport FeatureSelect from \"./FeatureSelect\";\r\nimport Search from \"./Search\";\r\nimport Legend from \"./Legend\";\r\nimport { Box, Theme } from \"@material-ui/core\";\r\nimport { withStyles } from \"@material-ui/styles\";\r\n\r\nconst styles = (theme: Theme) => ({});\r\n\r\ninterface State {\r\n    selectedStation: ObservationStation | null;\r\n    pins: MapPin[];\r\n    polygons: Polygon[];\r\n    viewport: Viewport;\r\n}\r\n\r\ninterface Props {\r\n    classes: any;\r\n}\r\n\r\nconst DEFAULT_MIN = 0;\r\nconst DEFAULT_MAX = 100;\r\n\r\nclass MapPage extends React.Component<Props, State> {\r\n    mapController: MapController;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.mapController = new MapController();\r\n\r\n        this.state = {\r\n            selectedStation: null,\r\n            viewport: this.mapController.getViewport(),\r\n            pins: [],\r\n            polygons: [],\r\n        };\r\n        this.update();\r\n    }\r\n\r\n    // Set station as source for the StationInfo Popup\r\n    changePopupStation(station: ObservationStation) {\r\n        this.setState({\r\n            selectedStation: station,\r\n        });\r\n    }\r\n\r\n    // Reload Pins and Polygons\r\n    update() {\r\n        var pinPromise = this.mapController.getPins();\r\n        var polyPromsie = this.mapController.getPolygons();\r\n        Promise.all([pinPromise, polyPromsie]).then((pinPoly) => {\r\n            this.setState({\r\n                pins: pinPoly[0],\r\n                polygons: pinPoly[1],\r\n            });\r\n        });\r\n    }\r\n\r\n    getValueAt(position: Position, feature: Feature): number {\r\n        // Get pins sorted by distance\r\n        var sortedPins = this.state.pins.sort((a, b) => {\r\n            return (\r\n                a.getPosition().getDistance(position) -\r\n                b.getPosition().getDistance(position)\r\n            );\r\n        });\r\n        var dis = 0; //Distance of nearest station to position\r\n        var disSum = 0;\r\n        if (sortedPins.length !== 0) {\r\n            dis = sortedPins[0].getPosition().getDistance(position);\r\n        }\r\n        var value = 0;\r\n        for (let i = 0; i <= 2; i++) {\r\n            //nearest 3 stations (if they exist)\r\n            if (sortedPins.length > i) {\r\n                var temp =\r\n                    dis / sortedPins[i].getPosition().getDistance(position); //Inverse of distance in comparison to nearest station\r\n                disSum += temp;\r\n                value += sortedPins[i].getValue() * temp; //Value, nearest with weight 1.\r\n            }\r\n        }\r\n        return value / (disSum === 0 ? 1 : disSum); //Catch division by zero (empty pin list)\r\n    }\r\n\r\n    onViewportChange(viewport: Viewport) {\r\n        this.mapController.handleViewportChange(viewport);\r\n        //Update Page\r\n        this.setState({\r\n            viewport: viewport,\r\n        });\r\n        this.update();\r\n    }\r\n\r\n    async onStationSelected(pin: MapPin): Promise<Observation> {\r\n        this.setState({ selectedStation: null });\r\n        var promise = this.mapController.handlePopup(pin);\r\n        promise.then((o) => this.changePopupStation(o.getObservationStation()));\r\n        return promise;\r\n    }\r\n\r\n    onSearch(term: string) {\r\n        this.mapController.search(term);\r\n        this.setState({ selectedStation: this.state.selectedStation });\r\n    }\r\n\r\n    getMin(): number {\r\n        var min = Math.min.apply(\r\n            Math,\r\n            this.state.pins.map((p) => {\r\n                return p.getValue();\r\n            })\r\n        );\r\n        if (!isFinite(min)) {\r\n            min = DEFAULT_MIN;\r\n        }\r\n        return min;\r\n    }\r\n\r\n    getMax(): number {\r\n        var max = Math.max.apply(\r\n            Math,\r\n            this.state.pins.map((p) => {\r\n                return p.getValue();\r\n            })\r\n        );\r\n        if (!isFinite(max)) {\r\n            max = DEFAULT_MAX;\r\n        }\r\n        return max;\r\n    }\r\n\r\n    render() {\r\n        var min = this.getMin();\r\n        var max = this.getMax();\r\n        return (\r\n            <Box>\r\n                <Search\r\n                    onSearch={(term) => this.onSearch(term)}\r\n                    updatePosition={(pos) => {\r\n                        var view = this.state.viewport;\r\n                        view.setCenter(pos);\r\n                        this.onViewportChange(view);\r\n                    }}\r\n                />\r\n                <Map\r\n                    viewport={this.state.viewport}\r\n                    onViewportChange={(viewport) => {\r\n                        this.onViewportChange(viewport);\r\n                    }}\r\n                    handlePopup={(pin) => this.onStationSelected(pin)}\r\n                    pins={this.state.pins}\r\n                    polygons={this.state.polygons}\r\n                />\r\n                <FeatureSelect\r\n                    onConfigurationChange={(conf) => {\r\n                        this.mapController.onConfigurationChange(conf);\r\n                        this.update();\r\n                    }}\r\n                    startConf={this.mapController.getFeatureSelectConf()}\r\n                />\r\n                <Box\r\n                    zIndex={1000}\r\n                    style={{ position: \"absolute\", bottom: \"7%\", right: \"5%\" }}\r\n                >\r\n                    <Legend\r\n                        min={min}\r\n                        max={max}\r\n                        scale={this.mapController.getScale()}\r\n                    />\r\n                </Box>\r\n            </Box>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(MapPage);\r\n","import React from 'react';\nimport { Fragment } from 'react';\n\nexport default class ErrorPage extends React.Component<IErrorPageProps, IErrorPageState> {\n\n    code: number;\n    message: string;\n\n    constructor(props: any) {\n        super(props);\n\n        this.code = this.props.code;\n        this.message = this.props.message;\n    }\n\n    render() {\n        return (\n            <Fragment>\n                <h1>Error</h1>\n                <h2>{this.code}</h2>\n                <p>{this.message}</p>\n            </Fragment>\n        );\n    }\n}\n\ninterface IErrorPageProps {\n    code: number;\n    message: string;\n}\n\ninterface IErrorPageState {\n\n\n}","import React from \"react\";\r\nimport { Fragment } from \"react\";\r\nimport Language from \"../Controller/Storage/Language\";\r\n\r\nlet language = Language.getInstance();\r\n\r\nexport default class AboutPage extends React.Component<\r\n    IAboutPageProps,\r\n    IAboutPageState\r\n    > {\r\n    render() {\r\n        return <Fragment>\r\n            <p>\r\n                <h1>{language.getText(\"about\")}</h1>\r\n                <h4>{language.getText(\"aboutText\")}</h4>\r\n            </p>\r\n\r\n        </Fragment>\r\n    }\r\n}\r\n\r\ninterface IAboutPageProps { }\r\n\r\ninterface IAboutPageState { }","import React from \"react\";\r\nimport { Fragment } from \"react\";\r\nimport Language from \"../Controller/Storage/Language\";\r\n\r\nlet language = Language.getInstance();\r\n\r\nexport default class PrivacyPolicyPage extends React.Component<\r\n    IPrivacyPolicyPageProps,\r\n    IPrivacyPolicyPageState\r\n    > {\r\n    render() {\r\n        return <Fragment>\r\n            <h1>{language.getText(\"privacyPolicy\")}</h1>\r\n            <h4>{language.getText(\"privacyPolicyText\")}</h4>\r\n        </Fragment>\r\n    }\r\n}\r\n\r\ninterface IPrivacyPolicyPageProps { }\r\n\r\ninterface IPrivacyPolicyPageState { }\r\n","import React from \"react\";\r\nimport { Menu, Button, MenuItem } from \"@material-ui/core\";\r\nimport { Translate, ExpandMore } from \"@material-ui/icons\";\r\nimport Language from \"../../Controller/Storage/Language\";\r\n\r\ninterface IState {\r\n  selectedLang: string;\r\n  anchorEl: Element | null;\r\n}\r\n\r\ninterface IProps {\r\n  language: Language;\r\n}\r\n\r\nexport default class LanguageMenu extends React.Component<IProps, IState> {\r\n  private availableLanguages: Map<string, string>;\r\n  private ref: any;\r\n  private language: Language;\r\n\r\n  constructor(props: IProps) {\r\n    super(props);\r\n    this.language = props.language;\r\n    this.state = {\r\n      selectedLang: this.language.getSelectedLanguage(),\r\n      anchorEl: null,\r\n    };\r\n    this.handleClick = this.handleClick.bind(this);\r\n    this.handleClose = this.handleClose.bind(this);\r\n\r\n    this.availableLanguages = this.language.getAvailabeleLanguages();\r\n  }\r\n\r\n  isSelectedLang(lang: string): boolean {\r\n    //return lang === this.state.selectedLang;\r\n    return false;\r\n  }\r\n\r\n  handleClick(event: React.MouseEvent<HTMLButtonElement>): void {\r\n    this.setState({ anchorEl: event.currentTarget });\r\n  }\r\n\r\n  handleClose(): void {\r\n    this.setState({ anchorEl: null });\r\n  }\r\n\r\n  handleMenuItemClick(event: React.MouseEvent<HTMLElement>, id: string): void {\r\n    this.language.changeLanguage(id);\r\n    window.location.reload();\r\n    this.setState({\r\n      anchorEl: null,\r\n      selectedLang: this.language.getSelectedLanguage(),\r\n    });\r\n  }\r\n\r\n  langList(): JSX.Element[] {\r\n    let list: JSX.Element[] = [];\r\n    this.availableLanguages.forEach((lang: string, id: string) => {\r\n      list.push(\r\n        <MenuItem\r\n          onClick={(e) => this.handleMenuItemClick(e, id)}\r\n          selected={id === this.language.getSelectedLanguageId()}\r\n        >\r\n          {lang}\r\n        </MenuItem>\r\n      );\r\n    });\r\n    return list;\r\n  }\r\n\r\n  render(): JSX.Element {\r\n    return (\r\n      <div>\r\n        <Button\r\n          onClick={this.handleClick}\r\n          color=\"inherit\"\r\n          startIcon={<Translate />}\r\n          endIcon={<ExpandMore />}\r\n          aria-controls=\"simple-menu\"\r\n          aria-haspopup=\"true\"\r\n        >\r\n          {this.state.selectedLang}\r\n        </Button>\r\n        <Menu\r\n          open={Boolean(this.state.anchorEl)}\r\n          anchorEl={this.state.anchorEl}\r\n          onClose={this.handleClose}\r\n        >\r\n          {this.langList()}\r\n        </Menu>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { AppBar, Toolbar, Typography, IconButton, SwipeableDrawer, List, ListItem, ListItemIcon, ListItemText } from '@material-ui/core';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport SecurityIcon from '@material-ui/icons/Security';\r\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\r\nimport LanguageMenu from './LanguageMenu';\r\nimport Language from '../../Controller/Storage/Language';\r\nimport { Fragment } from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\ninterface IPageMenuProps {\r\n    language: Language;\r\n}\r\n\r\ninterface IPageMenuState {\r\n    open: boolean;\r\n}\r\n\r\nexport default class PageMenu extends React.Component<IPageMenuProps, IPageMenuState> {\r\n\r\n    private language: Language;\r\n\r\n    constructor(props: IPageMenuProps) {\r\n        super(props);\r\n        this.language = props.language;\r\n        this.state = { open: false };\r\n        this.toogleDrawer = this.toogleDrawer.bind(this);\r\n    }\r\n\r\n    private toogleDrawer() {\r\n        const toogle = !this.state.open;\r\n        this.setState({ open: toogle });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Fragment>\r\n                <AppBar position=\"static\">\r\n                    <Toolbar>\r\n                        <Typography variant=\"h6\" component={Link} to='/pse-airquality-react/' style={{ textDecoration: 'none', color: 'unset' }}>\r\n                            SmartAQnet\r\n                        </Typography>\r\n                        <div style={{ marginLeft: 'auto' }}>\r\n\r\n                            <LanguageMenu language={this.language} />\r\n\r\n                        </div>\r\n                        <div>\r\n                            <IconButton style={{ float: 'right' }} onClick={this.toogleDrawer}>\r\n                                <MenuIcon />\r\n                            </IconButton>\r\n                        </div>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <SwipeableDrawer anchor=\"right\" open={this.state.open} onOpen={this.toogleDrawer} onClose={this.toogleDrawer}>\r\n                    <div style={{ width: 250 }}>\r\n                        <List>\r\n                            <ListItem button onClick={this.toogleDrawer} component={Link} to='/pse-airquality-react/privacy-policy'>\r\n                                <ListItemIcon>\r\n                                    <SecurityIcon />\r\n                                </ListItemIcon>\r\n                                <ListItemText primary={this.language.getText(\"privacyPolicy\")} />\r\n                            </ListItem>\r\n                            <ListItem button onClick={this.toogleDrawer} component={Link} to='/pse-airquality-react/about'>\r\n                                <ListItemIcon>\r\n                                    <InfoIcon />\r\n                                </ListItemIcon>\r\n                                <ListItemText primary={this.language.getText(\"about\")} />\r\n                            </ListItem>\r\n                            <ListItem button onClick={this.toogleDrawer} component='a' href='https://www.smartaq.net'>\r\n                                <ListItemIcon>\r\n                                    <ExitToAppIcon />\r\n                                </ListItemIcon>\r\n                                <ListItemText primary=\"SmartAQnet\" />\r\n                            </ListItem>\r\n                        </List>\r\n                    </div>\r\n                </SwipeableDrawer>\r\n            </Fragment>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport MapPage from \"../MapPage/MapPage\";\r\nimport DetailPage from \"./../DetailPage/DetailPage\";\r\nimport ErrorPage from \"../ErrorPage\";\r\nimport AboutPage from \"./../About\";\r\nimport PrivacyPolicyPage from \"./../PrivacyPolicy\";\r\nimport PageMenu from \"./PageMenu\";\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport Language from \"../../Controller/Storage/Language\";\r\n\r\nfunction Layout() {\r\n    let language: Language = Language.getInstance();\r\n\r\n    return (\r\n        <div className=\"App\">\r\n            <Router>\r\n                <PageMenu language={language} />\r\n                <Switch>\r\n                    <Route\r\n                        exact\r\n                        path=\"/pse-airquality-react/\"\r\n                        component={MapPage}\r\n                    />\r\n                    <Route\r\n                        exact\r\n                        path=\"/pse-airquality-react/detail/:id\"\r\n                        component={DetailPage}\r\n                    />\r\n                    <Route\r\n                        exact\r\n                        path=\"/pse-airquality-react/about\"\r\n                        component={AboutPage}\r\n                    />\r\n                    <Route\r\n                        exact\r\n                        path=\"/pse-airquality-react/privacy-policy\"\r\n                        component={PrivacyPolicyPage}\r\n                    />\r\n                    {/* If no url pattern matches an error page is shown */}\r\n                    <Route>\r\n                        <ErrorPage\r\n                            code={404}\r\n                            message={Language.getInstance().getText(\"Error404\")}\r\n                        />\r\n                    </Route>\r\n                </Switch>\r\n            </Router>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Layout;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport \"typeface-roboto\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { ThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\r\nimport purple from \"@material-ui/core/colors/purple\";\r\nimport lightGreen from \"@material-ui/core/colors/green\";\r\nimport Layout from \"./View/Layout/Layout\";\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            main: lightGreen[500],\r\n        },\r\n        secondary: {\r\n            main: purple[500],\r\n        },\r\n    },\r\n});\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <ThemeProvider theme={theme}>\r\n            <Layout />\r\n        </ThemeProvider>\r\n    </React.StrictMode>,\r\n    document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","export class Position {\r\n    private latitude: number;\r\n\r\n    private longitude: number;\r\n\r\n    constructor(latitude: number, longitude: number) {\r\n        if (Math.abs(latitude) >= 90 || Math.abs(longitude) >= 180) {\r\n            throw new Error(\r\n                \"Not valid coordinates: \" + latitude + \"N, \" + longitude + \"O\"\r\n            );\r\n        }\r\n        this.latitude = latitude;\r\n        this.longitude = longitude;\r\n    }\r\n\r\n    getDistance(pos: Position): number {\r\n        return Math.sqrt(\r\n            Math.pow(this.latitude - pos.getLatitude(), 2) +\r\n                Math.pow(this.longitude - pos.getLongitude(), 2)\r\n        );\r\n    }\r\n\r\n    getCoordinates(): { lat: number; lng: number } {\r\n        var lat = this.latitude;\r\n        var lng = this.longitude;\r\n        return { lat, lng };\r\n    }\r\n\r\n    getLatitude(): number {\r\n        return this.latitude;\r\n    }\r\n\r\n    getLongitude(): number {\r\n        return this.longitude;\r\n    }\r\n\r\n    getString(): string {\r\n        return (\r\n            (Math.round(this.latitude * 100) / 100).toString() +\r\n            \" N \" +\r\n            Math.round(this.longitude * 100) / 100 +\r\n            \" O\"\r\n        );\r\n    }\r\n}\r\n","import * as languageData from \"./languages.json\";\n\ninterface Lang {\n    id: string;\n    name: string;\n    strings: Strings;\n}\n\ninterface Strings {\n    [id: string]: string;\n}\n\nexport default class Language {\n    private static languageInstance: Language;\n\n    private selectedLangId: string;\n    private languages: Lang[];\n    private selectedLang: Lang;\n\n    constructor() {\n        this.selectedLangId = \"de-de\";\n        this.languages = languageData.languages;\n        this.selectedLang = this.languages[0];\n    }\n\n    public static getInstance(): Language {\n        if (!this.languageInstance) {\n            this.languageInstance = new Language();\n            var local = localStorage.getItem(\"language\");\n            if (local) {\n                //Change language if selected\n                this.languageInstance.changeLanguage(local);\n            }\n        }\n        return this.languageInstance;\n    }\n\n    public getText(id: string): string {\n        let text: string = this.selectedLang.strings[id];\n        if (text === \"\" || text == null) {\n            /*\n      alert(\n        \"There is no string with id: \" +\n          id +\n          \" in \" +\n          this.selectedLang.name +\n          \".\"\n      );\n      */\n            return \"STRING MISSING \" + id;\n        }\n        return text;\n    }\n\n    public getSelectedLanguage(): string {\n        return this.selectedLang.name;\n    }\n\n    public getSelectedLanguageId(): string {\n        return this.selectedLang.id;\n    }\n\n    public changeLanguage(languageID: string): void {\n        let find: Lang | undefined = this.languages.find(\n            (e) => e.id === languageID\n        );\n        if (find !== undefined) {\n            this.selectedLang = find;\n            this.selectedLangId = languageID;\n            localStorage.setItem(\"language\", this.selectedLangId);\n        }\n    }\n\n    public getAvailabeleLanguages(): Map<string, string> {\n        let langs: Map<string, string> = new Map<string, string>();\n        this.languages.forEach((element) => {\n            langs.set(element.id, element.name);\n        });\n        return langs;\n    }\n}\n","export class Color {\n    private r: number;\n    private g: number;\n    private b: number;\n\n    constructor(r: number, g: number, b: number) {\n        r = Math.floor(r);\n        g = Math.floor(g);\n        b = Math.floor(b);\n        //Creates a color from RGB values\n        if (r < 0 || r > 255 || g < 0 || g > 255 || b < 0 || b > 255) {\n            throw new TypeError(\n                \"r, g, b have to be an integer in [0, 255], are\" +\n                    r +\n                    \" \" +\n                    g +\n                    \" \" +\n                    b\n            );\n        }\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n\n    static getColorFromHex(hex: string): Color {\n        var regexp = /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/g;\n        var match = regexp.exec(hex);\n        if (!match) {\n            //Keine Hex-Farbe\n            throw new TypeError(\"hex has to be in format #RRGGBB\");\n        }\n        var r = parseInt(match[1], 16);\n        var g = parseInt(match[2], 16);\n        var b = parseInt(match[3], 16);\n\n        return new Color(r, g, b);\n    }\n\n    getRGB(): { r: number; g: number; b: number } {\n        var r = this.r;\n        var g = this.g;\n        var b = this.b;\n        return { r: r, g: g, b: b };\n    }\n\n    getHex(): string {\n        return (\n            \"#\" + this.toHex(this.r) + this.toHex(this.g) + this.toHex(this.b)\n        );\n    }\n\n    private toHex(n: number): string {\n        if (n < 0 || n > 255) {\n            return this.toHex(0); //This should never happen, only for reusing this method later.\n        }\n        var hex = n.toString(16).toUpperCase(); //Converts to upper-case-hex.\n        if (hex.length < 2) {\n            hex = \"0\" + hex; //Add padding if n < 16\n        }\n        return hex;\n    }\n}\n","import { ObservationStation } from './ObservationStation';\nimport { Feature } from './Feature';\n\nexport class Observation {\n    private observationStation: ObservationStation;\n    private feature: Feature;\n    private value: number;\n    private timestamp: Date;\n\n    constructor(observationStation: ObservationStation, feature: Feature, value: number, timestamp: Date) {\n        this.observationStation = observationStation;\n        this.feature = feature;\n        this.value = value;\n        this.timestamp = timestamp;\n    }\n\n    public getObservationStation(): ObservationStation {\n        return this.observationStation;\n    }\n\n    public getFeature(): Feature {\n        return this.feature;\n    }\n\n    public getValue(): number {\n        return this.value;\n    }\n\n    public getTimeStamp(): Date {\n        return this.timestamp;\n    }\n}","import { Position } from './Position';\r\nimport { Feature } from './Feature';\r\nimport IDiagramController from '../Controller/DiagramController/DiagramController';\r\n\r\nexport class ObservationStation {\r\n    private id: string;\r\n    private name: string;\r\n    private description: string;\r\n    private position: Position;\r\n    private availableFeatures: Feature[];\r\n\r\n    constructor(id: string, name: string, description: string, position: Position, availableFeatures: Feature[]) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.description = description;\r\n        this.position = position;\r\n        this.availableFeatures = availableFeatures;\r\n    }\r\n\r\n    public getId(): string {\r\n        return this.id;\r\n    }\r\n\r\n    public getName(): string {\r\n        return this.name;\r\n    }\r\n\r\n    public getDescription(): string {\r\n        return this.description;\r\n    }\r\n\r\n    public getPosition(): Position {\r\n        return this.position;\r\n    }\r\n\r\n    public getFeatures(): Feature[] {\r\n        return this.availableFeatures;\r\n    }\r\n\r\n    public getDiagramController(): IDiagramController[] {\r\n        var diagramController: IDiagramController[] = [];\r\n\r\n        this.availableFeatures.forEach(feature => {\r\n            let featureDiagramControllerArray = feature.getDiagramController(this);\r\n            featureDiagramControllerArray.forEach(contr => {\r\n                diagramController.push(contr);\r\n            });\r\n        });\r\n\r\n        return diagramController;\r\n    }\r\n\r\n    public hasFeature(feature: Feature): boolean {\r\n        //Not sure if this works \r\n        var found: boolean = false;\r\n        var length: number = this.availableFeatures.length;\r\n        for (var counter: number = 0; counter < length; counter++) {\r\n            if (feature === this.availableFeatures[counter]) {\r\n                found = true;\r\n            }\r\n        }\r\n        return found;\r\n    }\r\n}","import { Feature } from \"../Model/Feature\";\r\nimport { Observation } from \"../Model/Observation\";\r\nimport { ObservationStation } from \"../Model/ObservationStation\";\r\nimport { Position } from \"../Model/Position\";\r\nimport { Scale } from \"../Model/Scale\";\r\nimport { Color } from \"../Model/Color\";\r\n\r\nexport default class MockDataProvider {\r\n    private static stations: { [key: string]: ObservationStation } = {};\r\n\r\n    private static randomColor(): Color {\r\n        return new Color(\r\n            Math.random() * 255,\r\n            Math.random() * 255,\r\n            Math.random() * 255\r\n        );\r\n    }\r\n    static mockFeature(): Feature {\r\n        var colors: { [key: number]: string } = {};\r\n        for (let index = 0; index < 5; index++) {\r\n            var c = this.randomColor().getHex();\r\n            colors[Math.floor(Math.random() * 100)] = c;\r\n        }\r\n        var scale = new Scale(true, colors);\r\n        return new Feature(\r\n            \"MockFeature\",\r\n            \"nameId\",\r\n            \"descId\",\r\n            scale,\r\n            \"weblink\",\r\n            100,\r\n            \"uoM\",\r\n            ['YearComparisonLineChart', 'FeatureHistoryLineChart', 'ComparisonToLastYearPieChart'],\r\n            ''\r\n        );\r\n    }\r\n    private static mockStation(center: Position): ObservationStation {\r\n        var id = Math.floor(Math.random() * 10000).toString();\r\n        var station = new ObservationStation(\r\n            id,\r\n            \"mockName\",\r\n            \"mockDesc\",\r\n            new Position(\r\n                center.getLatitude() + 6 * Math.random() - 3,\r\n                center.getLongitude() + 6 * Math.random() - 3\r\n            ),\r\n            []\r\n        );\r\n        MockDataProvider.stations[station.getId()] = station;\r\n        return station;\r\n    }\r\n\r\n    private static mockObservations(center: Position): Observation[] {\r\n        var count = Math.floor(Math.random() * 9) + 2;\r\n        var obs = [];\r\n        for (let i = 0; i < count; i++) {\r\n            obs.push(\r\n                new Observation(\r\n                    this.mockStation(center),\r\n                    this.mockFeature(),\r\n                    Math.random() * 100,\r\n                    new Date(Date.now())\r\n                )\r\n            );\r\n        }\r\n        return obs;\r\n    }\r\n\r\n    static getLatestObservations(\r\n        center: Position,\r\n        radius: number,\r\n        feature: Feature\r\n    ): Observation[] {\r\n        return this.mockObservations(center);\r\n    }\r\n\r\n    static getLatestObservation(\r\n        station: ObservationStation,\r\n        feature: Feature\r\n    ): Observation {\r\n        return new Observation(\r\n            station,\r\n            feature,\r\n            Math.random() * 100,\r\n            new Date(Date.now())\r\n        );\r\n    }\r\n\r\n    static getObservations(\r\n        station: ObservationStation,\r\n        start: Date,\r\n        end: Date,\r\n        feature: Feature,\r\n        //how many observations per day are expected\r\n        frequency: number\r\n    ): Observation[] {\r\n        let date = start;\r\n        let observations = new Array<Observation>();\r\n\r\n        if (frequency <= 1) {\r\n            while (date.valueOf() < end.valueOf()) {\r\n                date = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1 / frequency);\r\n                let value = Math.random() * 100;\r\n                let observation = new Observation(station, feature, value, date);\r\n                observations.push(observation);\r\n            }\r\n        } else if (frequency > 1) {\r\n            while (date.valueOf() < end.valueOf()) {\r\n                date = new Date(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours() + 24 / frequency);\r\n                let value = Math.random() * 100;\r\n                let observation = new Observation(station, feature, value, date);\r\n                observations.push(observation);\r\n            }\r\n        }\r\n\r\n        return observations;\r\n    }\r\n\r\n    static getObservationStations(\r\n        middle: Position,\r\n        radius: number\r\n    ): ObservationStation[] {\r\n        var obs = [];\r\n        for (let index = 0; index < 7; index++) {\r\n            obs.push(this.mockStation(middle));\r\n        }\r\n        return obs;\r\n    }\r\n\r\n    static getStation(id: string): ObservationStation {\r\n        return new ObservationStation(\r\n            id,\r\n            'mockName',\r\n            'mockDesc',\r\n            new Position(0, 0),\r\n            [\r\n                this.mockFeature(),\r\n                this.mockFeature(),\r\n                this.mockFeature(),\r\n            ]\r\n        );\r\n    }\r\n}","import { Color } from \"./Color\";\n\nexport class Scale {\n    private linearTransition: boolean;\n    private dict: { [key: number]: string };\n\n    constructor(linearTransition: boolean, colors: { [key: number]: string }) {\n        this.linearTransition = linearTransition;\n        this.dict = colors;\n        this.sortOnKeys();\n    }\n\n    getColor(value: number): Color {\n        var keys = Object.keys(this.dict);\n        if (keys.length === 0) {\n            //Empty Scale\n            return Color.getColorFromHex(\"#AAAAAA\");\n        }\n        for (let index = 0; index < keys.length - 1; index++) {\n            if (\n                Number(keys[index]) <= value &&\n                Number(keys[index + 1]) > value\n            ) {\n                if (this.linearTransition) {\n                    return this.getLinearTransition(index, value); //Interpolate values of this and next index\n                } else {\n                    return Color.getColorFromHex(\n                        (this.dict[Number(keys[index])] as unknown) as string\n                    ); //Get Hex-Color directly.\n                }\n            }\n        }\n        return Color.getColorFromHex(\n            (this.dict[Number(keys[keys.length - 1])] as unknown) as string\n        ); //If the value is higher than any in the list, return highest value color.\n    }\n\n    private sortOnKeys() {\n        //Sorts the dictionary by key value (ascending).\n        var keys = Object.keys(this.dict);\n        var numKeys: number[] = [];\n\n        for (let i = 0; i < keys.length; i++) {\n            numKeys.push(Number(keys[i]));\n        }\n\n        numKeys.sort();\n        var tempDict: { [key: number]: string } = {};\n        for (let i = 0; i < keys.length; i++) {\n            tempDict[numKeys[i]] = this.dict[numKeys[i]];\n        }\n        this.dict = tempDict;\n    }\n\n    private getLinearTransition(lowerIndex: number, value: number): Color {\n        var a = [Number(Object.keys(this.dict)[lowerIndex]), \"\"]; // lower value\n        a[1] = this.dict[a[0] as number]; //Hex-Color of lower value\n        var b = [Number(Object.keys(this.dict)[lowerIndex + 1]), \"\"]; //higher value\n        b[1] = this.dict[b[0] as number]; //Hex-Color of higher value\n        var colorA = Color.getColorFromHex(a[1] as string).getRGB();\n        var colorB = Color.getColorFromHex(b[1] as string).getRGB();\n\n        //Interpolate all RGB values for colors A and B at value\n        var resR = this.interpolate(\n            [a[0] as number, colorA.r],\n            [b[0] as number, colorB.r],\n            value\n        );\n        var resG = this.interpolate(\n            [a[0] as number, colorA.g],\n            [b[0] as number, colorB.g],\n            value\n        );\n        var resB = this.interpolate(\n            [a[0] as number, colorA.b],\n            [b[0] as number, colorB.b],\n            value\n        );\n\n        return new Color(resR, resG, resB); //Color constructor floors values, decimals are cut off.\n    }\n\n    private interpolate(\n        a: [number, number],\n        b: [number, number],\n        value: number\n    ): number {\n        var add = b[0] - a[0];\n        return (\n            a[1] * ((add - value + a[0]) / add) +\n            b[1] * ((add - b[0] + value) / add)\n        ); //Interpolate with values a[0] and b[0] and weights a[1] and b[1] at value.\n    }\n}\n","import { ObservationStation } from \"../../Model/ObservationStation\";\r\nimport { Feature } from \"../../Model/Feature\";\r\n\r\nexport default interface IDiagramController {\r\n    observationStation: ObservationStation;\r\n    feature: Feature;\r\n\r\n    //returns type of chart\r\n    getChartType: () => ChartType,\r\n\r\n    //returns options that specify how the diagram is displayed\r\n    getGraphicsOptions: () => {},\r\n\r\n    //returns whether a diagram can be configured via a select form. In this case getSelectOprions must return an Array of select options\r\n    isConfigurable: () => boolean,\r\n\r\n    //returns all options that can be selected to configure the diagram\r\n    getConfigurationOptions: () => string[],\r\n\r\n    //returns default configuration option\r\n    getDefaultConfigurationOption: () => string,\r\n\r\n    //returns the data that can be displayed in the diagram\r\n    getData: (configurationOptionName: string) => any[][],\r\n}\r\n\r\nexport enum ChartType {\r\n    LINE_CHART = 'LineChart',\r\n    PIE_CHART = 'PieChart',\r\n}","export default class Timespan {\r\n\r\n  //length in milliseconds\r\n  length: number;\r\n\r\n  constructor(length: number) {\r\n    this.length = length;\r\n  }\r\n\r\n  //returns the end of a timespan given the start date\r\n  public getEnd(start: Date): Date {\r\n    return (new Date(start.valueOf() + this.length));\r\n  }\r\n\r\n  //returns the start of a timespan given the end date\r\n  public getStart(end: Date): Date {\r\n    return (new Date(end.valueOf() - this.length));\r\n  }\r\n}\r\n","import IDiagramController, { ChartType } from './DiagramController';\r\nimport { ObservationStation } from '../../Model/ObservationStation';\r\nimport { Feature } from '../../Model/Feature';\r\nimport Timespan from '../../Model/Timespan';\r\nimport MockDataProvider from '../MockDataProvider';\r\n\r\nclass FHLCConfigurationOption {\r\n    name: string;\r\n    timespan: Timespan;\r\n    frequency: number;\r\n    //type and label for the xAxis\r\n    xAxis: { type: string, label: string };\r\n\r\n    constructor(name: string, timespan: Timespan, frequency: number, xAxis: { type: string, label: string }) {\r\n        this.name = name;\r\n        this.timespan = timespan;\r\n        this.frequency = frequency;\r\n        this.xAxis = xAxis;\r\n    }\r\n}\r\n\r\nexport class FeatureHistoryLineChartController implements IDiagramController {\r\n    //support line charts\r\n    private static readonly chartType = ChartType.LINE_CHART;\r\n\r\n    //enable configuration\r\n    private static readonly isConfigutable = true;\r\n\r\n    //configuration options\r\n    private static readonly configurationOptions = [\r\n        //last 24 hours\r\n        new FHLCConfigurationOption('last_24_hours', new Timespan(24 * 60 * 60 * 1000), 24, { type: 'date', label: 'Day' }),\r\n        //last 7 days\r\n        new FHLCConfigurationOption('last_7_days', new Timespan(7 * 24 * 60 * 60 * 1000), 12, { type: 'date', label: 'Day' }),\r\n        //last 31 days\r\n        new FHLCConfigurationOption('last_31_days', new Timespan(31 * 24 * 60 * 60 * 1000), 6, { type: 'date', label: 'Day' }),\r\n        //last year\r\n        new FHLCConfigurationOption('last_year', new Timespan(365 * 24 * 60 * 60 * 1000), 1, { type: 'date', label: 'Day' }),\r\n    ];\r\n\r\n    //default configuration option\r\n    private static readonly defaultConfigurationOption = FeatureHistoryLineChartController.configurationOptions[0];\r\n\r\n    // options for the graphical appearence\r\n    private static readonly graphicsOptions = {};\r\n\r\n    //concerning observation station\r\n    observationStation: ObservationStation;\r\n    //concerning feature\r\n    feature: Feature;\r\n    yAxisLabel: string;\r\n\r\n    constructor(observationStation: ObservationStation, feature: Feature) {\r\n        this.observationStation = observationStation;\r\n        this.feature = feature;\r\n        this.yAxisLabel = this.feature.getName() + '[' + this.feature.getUnitOfMeasurement() + ']';\r\n    }\r\n    //return chart type\r\n    getChartType(): ChartType {\r\n        return FeatureHistoryLineChartController.chartType;\r\n    };\r\n\r\n    getGraphicsOptions() {\r\n        return FeatureHistoryLineChartController.graphicsOptions;\r\n    }\r\n\r\n    //return names of graphics options\r\n    getViewOptions() {\r\n        return FeatureHistoryLineChartController.graphicsOptions;\r\n    }\r\n\r\n    //return that the corresponding diagram to this controller is configurable\r\n    isConfigurable() {\r\n        return FeatureHistoryLineChartController.isConfigutable;\r\n    }\r\n\r\n    //returns default configuration option\r\n    getDefaultConfigurationOption(): string {\r\n        return FeatureHistoryLineChartController.defaultConfigurationOption.name;\r\n    }\r\n\r\n    //return names of configuration options\r\n    getConfigurationOptions(): string[] {\r\n        var optionNames = FeatureHistoryLineChartController.configurationOptions.map(option => option.name);\r\n        return optionNames;\r\n    }\r\n\r\n    //return data to display\r\n    getData(configurationOptionName: string): any[][] {\r\n        //get option object\r\n        var configurationOption: FHLCConfigurationOption = this.getFHLCConfigurationOption(configurationOptionName);\r\n\r\n        //get timespan\r\n        var end: Date = new Date(Date.now());\r\n        var start: Date = configurationOption.timespan.getStart(end);\r\n\r\n        //get mock observations\r\n        var observations = MockDataProvider.getObservations(\r\n            this.observationStation,\r\n            start,\r\n            end,\r\n            this.feature,\r\n            configurationOption.frequency,\r\n        );\r\n\r\n        //add react google chart specific header\r\n        var data: any[] = [\r\n            [\r\n                configurationOption.xAxis,\r\n                this.yAxisLabel,\r\n            ],\r\n        ];\r\n\r\n        //extract values and timestamps from observations\r\n        observations.forEach(observation => {\r\n            let timestamp = observation.getTimeStamp();\r\n            let value = observation.getValue();\r\n            data.push([timestamp, value]);\r\n        });\r\n\r\n        return data;\r\n    }\r\n\r\n    //get configuration option by name\r\n    private getFHLCConfigurationOption(name: string): FHLCConfigurationOption {\r\n        var options = FeatureHistoryLineChartController.configurationOptions;\r\n\r\n        for (let i = 0; i < options.length; i++) {\r\n\r\n            //if option matches return it\r\n            if (options[i].name === name) {\r\n                return options[i];\r\n            }\r\n\r\n        }\r\n\r\n        //no option matches, throw an error\r\n        throw new Error(`${name} is an invalid configuration option for a diagram of type FeatureHistoryLineChart`);\r\n    }\r\n}\r\n\r\n","import IDiagramController, { ChartType } from './DiagramController';\r\nimport { ObservationStation } from '../../Model/ObservationStation';\r\nimport { Feature } from '../../Model/Feature';\r\nimport Timespan from '../../Model/Timespan';\r\nimport MockDataProvider from '../MockDataProvider';\r\n\r\n\r\nclass CTLYPCConfigurationOption {\r\n    name: string;\r\n    timespan: Timespan;\r\n    frequency: number;\r\n\r\n    constructor(name: string, timespan: Timespan, frequency: number) {\r\n        this.name = name;\r\n        this.timespan = timespan;\r\n        this.frequency = frequency;\r\n    }\r\n}\r\n\r\nexport class ComparisonToLastYearPieChartController implements IDiagramController {\r\n    //support line charts\r\n    private static readonly chartType = ChartType.PIE_CHART;\r\n\r\n    //enable configuration\r\n    private static readonly isConfigurable = false;\r\n\r\n    // options for the graphical appearence\r\n    private static readonly graphicsOptions = {};\r\n\r\n    //configuration options\r\n    private static readonly configurationOptions = [\r\n        new CTLYPCConfigurationOption('default_configuration', new Timespan(365 * 24 * 60 * 60 * 1000), 24),\r\n    ];\r\n\r\n    //default configuration option\r\n    private static readonly defaultConfigurationOption = ComparisonToLastYearPieChartController.configurationOptions[0];\r\n\r\n    observationStation: ObservationStation;\r\n    feature: Feature;\r\n\r\n    constructor(observationStation: ObservationStation, feature: Feature) {\r\n        this.observationStation = observationStation;\r\n        this.feature = feature;\r\n    }\r\n\r\n    getChartType(): ChartType {\r\n        return ComparisonToLastYearPieChartController.chartType;\r\n    }\r\n\r\n    getGraphicsOptions() {\r\n        return ComparisonToLastYearPieChartController.graphicsOptions;\r\n    }\r\n\r\n    isConfigurable() {\r\n        return ComparisonToLastYearPieChartController.isConfigurable;\r\n    }\r\n\r\n    getConfigurationOptions() {\r\n        return ComparisonToLastYearPieChartController.configurationOptions.map(option => option.name);\r\n    };\r\n\r\n    getDefaultConfigurationOption() {\r\n        return ComparisonToLastYearPieChartController.defaultConfigurationOption.name;\r\n    }\r\n\r\n    getData(configurationOptionName: string): any[][] {\r\n        //configuration option by name\r\n        var configuration = this.getCTLYPCConfigurationOption(configurationOptionName);\r\n\r\n        //get timespan\r\n        var end: Date = new Date(Date.now());\r\n        var start: Date = configuration.timespan.getStart(end);\r\n\r\n        //get mock observations\r\n        var observations = MockDataProvider.getObservations(\r\n            this.observationStation,\r\n            start,\r\n            end,\r\n            this.feature,\r\n            configuration.frequency,\r\n        );\r\n\r\n        var lastObservationValue = observations.pop()?.getValue() as number;\r\n\r\n        var higher = 0;\r\n        var lower = 0;\r\n\r\n        observations.forEach(observation => {\r\n            (observation.getValue() > lastObservationValue) ? (higher++) : (lower++);\r\n        });\r\n\r\n        var data = [\r\n            ['Vergleich zum letzten Messwert', 'Anzahl Tage'],\r\n            ['higher', higher],\r\n            ['lower', lower],\r\n        ];\r\n        return data;\r\n    }\r\n\r\n    //get configuration option by name\r\n    private getCTLYPCConfigurationOption(name: string): CTLYPCConfigurationOption {\r\n        var options = ComparisonToLastYearPieChartController.configurationOptions;\r\n\r\n        for (let i = 0; i < options.length; i++) {\r\n\r\n            //if option matches return it\r\n            if (options[i].name === name) {\r\n                return options[i];\r\n            }\r\n\r\n        }\r\n\r\n        //no option matches, throw an error\r\n        throw new Error(`${name} is an invalid configuration option for a diagram of type ComparisonToLastYearPieChart`);\r\n    }\r\n}\r\n\r\n","import IDiagramController, { ChartType } from './DiagramController';\r\nimport { ObservationStation } from '../../Model/ObservationStation';\r\nimport { Feature } from '../../Model/Feature';\r\nimport MockDataProvider from '../MockDataProvider';\r\n\r\nclass YCLCCConfigurationOption {\r\n    name: string;\r\n    numberOfYears: number;\r\n    frequency: number;\r\n\r\n    constructor(name: string, numberOfYears: number, frequency: number) {\r\n        this.name = name;\r\n        this.numberOfYears = numberOfYears;\r\n        this.frequency = frequency;\r\n    }\r\n}\r\n\r\nexport class YearComparisonLineChartController implements IDiagramController {\r\n    //support line charts\r\n    private static readonly chartType = ChartType.LINE_CHART;\r\n\r\n    //enable configuration\r\n    private static readonly isConfigutable = false;\r\n\r\n    //configuration options\r\n    private static readonly configurationOptions = [\r\n        new YCLCCConfigurationOption('default_configuration', 3, 1),\r\n    ];\r\n\r\n    //default configuration option\r\n    private static readonly defaultConfigurationOption = new YCLCCConfigurationOption('default_configuration', 10, 1);\r\n\r\n    // options for the graphical appearence\r\n    private static readonly graphicsOptions = {\r\n        hAxis: {\r\n            format: 'MMM',\r\n            gridlines: { count: 6 }\r\n        },\r\n    };\r\n\r\n    //concerning observation station\r\n    observationStation: ObservationStation;\r\n    //concerning feature\r\n    feature: Feature;\r\n    yAxisLabel: string;\r\n\r\n    constructor(observationStation: ObservationStation, feature: Feature) {\r\n        this.observationStation = observationStation;\r\n        this.feature = feature;\r\n        this.yAxisLabel = `${this.feature.getName()} [${this.feature.getUnitOfMeasurement()}]`;\r\n    }\r\n    //return chart type\r\n    getChartType(): ChartType {\r\n        return YearComparisonLineChartController.chartType;\r\n    };\r\n\r\n    getGraphicsOptions() {\r\n        return YearComparisonLineChartController.graphicsOptions;\r\n    }\r\n\r\n    //return that the corresponding diagram to this controller is configurable\r\n    isConfigurable() {\r\n        return YearComparisonLineChartController.isConfigutable;\r\n    }\r\n\r\n    //returns default configuration option\r\n    getDefaultConfigurationOption(): string {\r\n        return YearComparisonLineChartController.defaultConfigurationOption.name;\r\n    }\r\n\r\n    //return names of configuration options\r\n    getConfigurationOptions(): string[] {\r\n        return YearComparisonLineChartController.configurationOptions.map(option => option.name);\r\n    }\r\n\r\n    getYCLCCConfigurationOption(name: string) {\r\n        for (let option of YearComparisonLineChartController.configurationOptions) {\r\n            if (option.name === name) return option;\r\n        }\r\n        throw new Error('Configuration option: ' + name + ' does not exist for YearComparisonLineChart');\r\n    }\r\n\r\n    //return data to display\r\n    getData(configurationOptionName: string): Array<Array<string | Date | number | null>> {\r\n        let configurationOption = this.getYCLCCConfigurationOption(configurationOptionName);\r\n        let numberOfYears = configurationOption.numberOfYears;\r\n        let frequency = configurationOption.frequency;\r\n\r\n        let now = new Date(Date.now());\r\n\r\n        //start of timespan\r\n        let start = new Date(now.getFullYear() - numberOfYears, 0, 1);\r\n        //end of timespan\r\n        let end = now;\r\n\r\n        //request (mock-)data\r\n        let observations = MockDataProvider.getObservations(this.observationStation, start, end, this.feature, frequency);\r\n\r\n        //filter out the null values\r\n        let cleanedObservations = observations.filter(observation => {\r\n            return (observation !== null);\r\n        });\r\n\r\n        //determine the displayed years\r\n        let years: number[] = new Array<number>();\r\n        for (let i = 0; i < numberOfYears; i++) {\r\n            years.push(now.getFullYear() - i);\r\n        }\r\n\r\n        //define header\r\n        let header: string[] = years.map(year => year.toString());\r\n        header.splice(0, 0, 'dates');\r\n\r\n\r\n        //define new data table with header\r\n        let dt = new DataTable(header)\r\n\r\n        //add every observation to the table\r\n        for (let observation of cleanedObservations) {\r\n            let date = observation.getTimeStamp();\r\n            let year = date.getFullYear().toString();\r\n            let value = observation.getValue();\r\n            dt.addValue(date, year, value);\r\n        }\r\n\r\n        //return data table as a twodimensional array\r\n        let dtAsArray = dt.toArray();\r\n        console.log(dtAsArray);\r\n        return dtAsArray;\r\n    }\r\n}\r\n\r\nclass DTRow {\r\n    date: Date;\r\n    values: Array<number>;\r\n\r\n    constructor(date: Date, numberOfValues: number) {\r\n        this.date = date;\r\n        this.values = new Array<number>(numberOfValues);\r\n    }\r\n\r\n    addValue(value: number, index: number) {\r\n        this.values[index] = value;\r\n    }\r\n\r\n    toArray(): Array<Date | number> {\r\n        let arrayRepresentation = new Array<Date | number>();\r\n        arrayRepresentation = this.values;\r\n        arrayRepresentation.splice(0, 0, this.date);\r\n        return arrayRepresentation;\r\n    }\r\n\r\n    static sort(dtrowA: DTRow, dtrowB: DTRow): number {\r\n        return ((dtrowA.date.valueOf() <= dtrowB.date.valueOf() ? -1 : 1));\r\n    }\r\n}\r\n\r\nclass DataTable {\r\n    static readonly BASE_YEAR = 2020;\r\n\r\n    header: string[];\r\n    rows: DTRow[];\r\n    numberOfValues: number;\r\n\r\n    constructor(header: string[]) {\r\n        this.header = header;\r\n        this.numberOfValues = header.length - 1;\r\n        this.rows = new Array<DTRow>();\r\n    }\r\n\r\n    addValue(date: Date, columnKey: string, value: number) {\r\n        //get row\r\n        let rowIndex = this.getRowIndex(date);\r\n        if (rowIndex === null) {\r\n            this.rows.push(new DTRow(this.getBaseDate(date), this.numberOfValues));\r\n            rowIndex = (this.rows.length - 1);\r\n        }\r\n\r\n        //get column\r\n        let columnIndex = this.getColumnIndex(columnKey);\r\n        if (columnKey === null) {\r\n            throw new Error(`No column key: ${columnKey} in this data table`);\r\n        }\r\n        columnIndex = columnIndex as number;\r\n\r\n        //add value\r\n        this.rows[rowIndex].addValue(value, columnIndex);\r\n    }\r\n\r\n    getColumnIndex(key: string): number | null {\r\n        for (let index = 0; index < this.header.length; index++) {\r\n            if (key === this.header[index]) {\r\n                return (index - 1);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getRowIndex(date: Date): number | null {\r\n        for (let index = 0; index < this.rows.length; index++) {\r\n            if (this.datesAreEqual(date, this.rows[index].date)) {\r\n                return index;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    getBaseDate(date: Date) {\r\n        let baseDate = new Date(\r\n            DataTable.BASE_YEAR,\r\n            date.getMonth(),\r\n            date.getDate(),\r\n            date.getHours(),\r\n            date.getMinutes(),\r\n            date.getSeconds(),\r\n            date.getMilliseconds(),\r\n        );\r\n        return baseDate;\r\n    }\r\n\r\n    //returns whether two dates are the same except their years\r\n    datesAreEqual(dateA: Date, dateB: Date): boolean {\r\n        let equal: boolean =\r\n            (dateA.getMonth() === dateB.getMonth()) &&\r\n            (dateA.getDate() === dateB.getDate()) &&\r\n            (dateA.getHours() === dateB.getHours()) &&\r\n            (dateA.getMinutes() === dateB.getMinutes()) &&\r\n            (dateA.getSeconds() === dateB.getSeconds()) &&\r\n            (dateA.getMilliseconds() === dateB.getMilliseconds());\r\n        return equal;\r\n    }\r\n\r\n    sort() {\r\n        this.rows.sort(DTRow.sort);\r\n    }\r\n\r\n    toArray() {\r\n        this.sort();\r\n\r\n        let arrayRepresentation = new Array<Array<string | Date | number | null>>();\r\n        arrayRepresentation = this.rows.map(row => row.toArray());\r\n        arrayRepresentation.splice(0, 0, this.header);\r\n        return arrayRepresentation;\r\n    }\r\n}\r\n\r\n","import { ObservationStation } from '../../Model/ObservationStation';\r\nimport { Feature } from '../../Model/Feature';\r\nimport { FeatureHistoryLineChartController } from './FeatureHistoryLineChartController';\r\nimport { ComparisonToLastYearPieChartController } from './ComparisonToLastYearPieChartController';\r\nimport { YearComparisonLineChartController } from './YearComparisonLineChartController';\r\nimport IDiagramController from './DiagramController';\r\n\r\nexport default class DiagramFactory {\r\n    private static readonly diagramMap = new Map<string, Function>([\r\n        ['FeatureHistoryLineChart', (observationStation: ObservationStation, feature: Feature) => { return new FeatureHistoryLineChartController(observationStation, feature) }],\r\n        ['ComparisonToLastYearPieChart', (observationStation: ObservationStation, feature: Feature) => { return new ComparisonToLastYearPieChartController(observationStation, feature) }],\r\n        ['YearComparisonLineChart', (observationStation: ObservationStation, feature: Feature) => { return new YearComparisonLineChartController(observationStation, feature) }],\r\n    ]);\r\n\r\n    public static getDiagramController(id: string, observationStation: ObservationStation, feature: Feature): IDiagramController {\r\n        if (DiagramFactory.diagramMap.has(id)) {\r\n            var constructController = DiagramFactory.diagramMap.get(id) as Function;\r\n            return constructController.call(DiagramFactory, observationStation, feature);\r\n        } else {\r\n            throw new Error(`Diagram id: ${id}, is not supported`);\r\n        }\r\n    }\r\n\r\n}\r\n","import { Scale } from \"./Scale\";\r\nimport { Observation } from \"./Observation\";\r\nimport { ObservationStation } from \"./ObservationStation\";\r\nimport Language from \"../Controller/Storage/Language\";\r\nimport DiagramFactory from \"../Controller/DiagramController/DiagramFactory\";\r\nimport IDiagramController from \"../Controller/DiagramController/DiagramController\";\r\n\r\nlet language = Language.getInstance();\r\n\r\nexport class Feature {\r\n    private id: string;\r\n    private nameId: string;\r\n    private descriptionId: string;\r\n    private scale: Scale;\r\n    private relatedWeblinkId: string;\r\n    private limit: number;\r\n    private unitOfMeasurement: string;\r\n    private controllerIds: string[];\r\n    private iconName: string;\r\n\r\n    constructor(\r\n        id: string,\r\n        nameId: string,\r\n        descriptionId: string,\r\n        scale: Scale,\r\n        relatedWeblinkId: string,\r\n        limit: number,\r\n        unitOfMeasurement: string,\r\n        controllerIds: string[],\r\n        iconName: string\r\n    ) {\r\n        this.id = id;\r\n        this.nameId = nameId;\r\n        this.descriptionId = descriptionId;\r\n        this.scale = scale;\r\n        this.relatedWeblinkId = relatedWeblinkId;\r\n        this.limit = limit;\r\n        this.unitOfMeasurement = unitOfMeasurement;\r\n        this.controllerIds = controllerIds;\r\n        this.iconName = iconName;\r\n    }\r\n\r\n    public getId(): string {\r\n        return this.id;\r\n    }\r\n\r\n    public getName(): string {\r\n        return language.getText(this.nameId);\r\n        //return this.nameId;\r\n    }\r\n\r\n    public getDescription(): string {\r\n        return language.getText(this.descriptionId);\r\n        //return this.descriptionId;\r\n    }\r\n\r\n    public getRelatedWeblink(): string {\r\n        return language.getText(this.relatedWeblinkId);\r\n        //return this.relatedWeblinkId;\r\n    }\r\n\r\n    public getRelatedScale(): Scale {\r\n        return this.scale;\r\n    }\r\n\r\n    public getDiagramController(\r\n        observationStation: ObservationStation\r\n    ): IDiagramController[] {\r\n        var diagramController = new Array<IDiagramController>();\r\n\r\n        this.controllerIds.forEach((id) => {\r\n            let controller = DiagramFactory.getDiagramController(\r\n                id,\r\n                observationStation,\r\n                this\r\n            );\r\n            diagramController.push(controller);\r\n        });\r\n\r\n        return diagramController;\r\n    }\r\n\r\n    public getLimit(): number {\r\n        return this.limit;\r\n    }\r\n\r\n    public getUnitOfMeasurement(): string {\r\n        return this.unitOfMeasurement;\r\n    }\r\n\r\n    public isLimitExceeded(observation: Observation): boolean {\r\n        return observation.getValue() > this.limit;\r\n    }\r\n\r\n    public getIconName(): string {\r\n        return this.iconName;\r\n    }\r\n}\r\n","import React from 'react';\r\nimport { Grid } from '@material-ui/core';\r\nimport Hidden from '@material-ui/core/Hidden';\r\n\r\nimport MockDataProvider from '../../Controller/MockDataProvider';\r\n\r\nimport { ObservationStation } from '../../Model/ObservationStation';\r\n\r\nimport ObservationStationProfile from './ObservationStationProfile';\r\nimport LocationMap from './LocationMap';\r\nimport Diagram from './Diagram';\r\n\r\nexport default class DetailPage extends React.Component<IDetailPageProps, IDetailPageState> {\r\n\r\n    //the concerning observation station of this page\r\n    observationStation: ObservationStation;\r\n\r\n    constructor(props: IDetailPageProps) {\r\n        super(props);\r\n\r\n        //get observation station by id\r\n        this.observationStation = MockDataProvider.getStation(this.props.id);\r\n    }\r\n\r\n    //styles of this component\r\n    styles = {\r\n        main_container: {\r\n            paddingTop: '20px',\r\n        },\r\n    }\r\n\r\n    //return diagrams of this observation station\r\n    renderDiagrams() {\r\n        var diagramController = this.observationStation.getDiagramController();\r\n        return (\r\n            diagramController.map((controller) => (\r\n                <Grid item xl={6} lg={6} md={6} sm={6} xs={6} >\r\n                    <Diagram controller={controller} />\r\n                </Grid>)\r\n            ));\r\n    }\r\n\r\n    //render component\r\n    render() {\r\n        return (\r\n            <Grid container justify='center'>\r\n                <Grid container justify='center' spacing={4} xl={8} lg={8} md={8} sm={12} xs={12} style={this.styles.main_container}>\r\n                    <Grid item xl={8} lg={8} md={8} sm={12} xs={12} >\r\n                        <ObservationStationProfile observationStation={this.observationStation} />\r\n                    </Grid>\r\n                    <Hidden only={['sm', 'xs']}>\r\n                        <Grid item xl={4} lg={4} md={4}>\r\n                            <LocationMap position={this.observationStation.getPosition()} />\r\n                        </Grid>\r\n                    </Hidden>\r\n                    {this.renderDiagrams()}\r\n                </Grid>\r\n            </Grid>\r\n        );\r\n    }\r\n}\r\n\r\ninterface IDetailPageProps {\r\n    id: string;\r\n}\r\n\r\ninterface IDetailPageState { }\r\n","import React from 'react';\r\nimport {\r\n    Card,\r\n    Typography,\r\n    Divider,\r\n    CardContent,\r\n    Grid,\r\n} from '@material-ui/core';\r\n\r\nimport { ObservationStation } from '../../Model/ObservationStation';\r\nimport ObservationItem from './ObservationItem';\r\nimport MockDataProvider from '../../Controller/MockDataProvider';\r\nimport { Color } from '../../Model/Color';\r\nimport { Observation } from '../../Model/Observation';\r\n\r\nexport default class ObservationStationProfile extends React.Component<IObservationStationProfileProps, IObservationStationProfileState> {\r\n\r\n    //the corresponding observation station to this component\r\n    observationStation: ObservationStation;\r\n\r\n    constructor(props: IObservationStationProfileProps) {\r\n        super(props);\r\n        this.observationStation = this.props.observationStation;\r\n        this.state = {\r\n            latestObservations: this.getLatestObservations(),\r\n        }\r\n    }\r\n\r\n    //styles for this component\r\n    styles = {\r\n        pos: {\r\n            marginBottom: 12,\r\n        },\r\n        section_1: {\r\n            padding: '20px',\r\n        },\r\n        section_2: {\r\n            padding: '20px',\r\n        },\r\n        feature_container: {\r\n            marginTop: '20px',\r\n        },\r\n    }\r\n\r\n    //colors that are asignable to the observation items icons\r\n    colors = [\r\n        '#f44336',\r\n        '#e91e63',\r\n        '#9c27b0',\r\n        '#673ab7',\r\n        '#3f51b5',\r\n        '#2196f3',\r\n        '#00bcd4',\r\n        '#009688',\r\n        '#4caf50',\r\n        '#8bc34a',\r\n        '#cddc39',\r\n        '#ffeb3b',\r\n        '#ffc107',\r\n        '#ff9800',\r\n        '#ff5722',\r\n        '#795548',\r\n        '#9e9e9e',\r\n        '#607d8b',\r\n    ];\r\n\r\n\r\n    //returns the latest observation for each feature of this observation station\r\n    private getLatestObservations() {\r\n        var features = this.observationStation.getFeatures();\r\n        var observations = new Array<Observation>();\r\n\r\n        features.forEach(feature => {\r\n            let observation = MockDataProvider.getLatestObservation(this.observationStation, feature);\r\n            observations.push(observation);\r\n        });\r\n\r\n        return observations;\r\n    }\r\n\r\n    //returns a random color from the above ones\r\n    private getRandomColor() {\r\n        var randomNumber = Math.round(Math.random() * (this.colors.length - 1));\r\n        var color = this.colors[randomNumber];\r\n        this.colors.splice(randomNumber, 1);\r\n        return Color.getColorFromHex(color);\r\n    }\r\n\r\n    //returns JSX Elements for each latest observation\r\n    private renderLatestObservations() {\r\n        return this.state.latestObservations.map((observation) =>\r\n            <Grid item xl={6} lg={6} md={6} sm={12} xs={12}>\r\n                <ObservationItem color={this.getRandomColor()} observation={observation} />\r\n            </Grid>\r\n        );\r\n    }\r\n\r\n    //returns the timestamp of the latest observation as a readable string\r\n    private renderObservationDate() {\r\n        if (this.state.latestObservations.length !== 0) {\r\n            var timestamp = this.state.latestObservations[0].getTimeStamp();\r\n\r\n            var year = timestamp.getFullYear();\r\n            var month = timestamp.getMonth();\r\n            var day = timestamp.getDay();\r\n            var hour = timestamp.getHours();\r\n            var minute = timestamp.getMinutes();\r\n\r\n            return this.getDateString(year, month, day, hour, minute);\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    //returns a readable date string\r\n    private getDateString(year: number, month: number, day: number, hour: number, minute: number) {\r\n        var parameters: number[] = [year, month, day, hour, minute];\r\n        var strParameters: string[] = parameters.map((num) => num.toString());\r\n        strParameters = strParameters.map((str) => {\r\n            if (str.length === 1) {\r\n                return ('0' + str);\r\n            } else {\r\n                return str;\r\n            }\r\n        });\r\n        return '' + strParameters[2] + '.' + strParameters[1] + '.' + strParameters[0] + ', ' + strParameters[3] + ':' + strParameters[4] + ' Uhr';\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Card>\r\n                <CardContent>\r\n                    <div style={this.styles.section_1}>\r\n                        <Typography align=\"left\" variant=\"h4\" component='h2' >\r\n                            {this.observationStation.getName()}\r\n                        </Typography>\r\n                        <Typography align=\"left\" color='textSecondary' component=\"p\" style={this.styles.pos}>\r\n                            {this.observationStation.getPosition().getString()}\r\n                        </Typography>\r\n                        <Typography align='left' variant=\"body2\" component=\"p\" >\r\n                            {this.observationStation.getDescription()}\r\n                        </Typography>\r\n                    </div>\r\n                    <Divider variant=\"middle\" />\r\n                    <div style={this.styles.section_2}>\r\n                        <Grid container alignItems='stretch'>\r\n                            <Grid item xs>\r\n                                <Typography align='left' variant='subtitle1'>\r\n                                    Letzte Messung\r\n                                </Typography>\r\n                            </Grid>\r\n                            <Grid item>\r\n                                <Typography color='textSecondary' variant='subtitle1'>\r\n                                    {this.renderObservationDate()}\r\n                                </Typography>\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid container style={this.styles.feature_container} spacing={2}>\r\n\r\n                            {this.renderLatestObservations()}\r\n\r\n                        </Grid>\r\n                    </div>\r\n                </CardContent>\r\n            </Card >\r\n        );\r\n    }\r\n}\r\n\r\ninterface IObservationStationProfileProps {\r\n    observationStation: ObservationStation;\r\n}\r\n\r\ninterface IObservationStationProfileState {\r\n    latestObservations: Observation[],\r\n}\r\n\r\n","import React from 'react';\r\n\r\nimport {\r\n    Card,\r\n    Grid,\r\n    Avatar,\r\n    Typography,\r\n    CardContent,\r\n} from '@material-ui/core';\r\n\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faThermometerHalf } from '@fortawesome/free-solid-svg-icons'\r\n\r\nimport { Color } from '../../Model/Color';\r\nimport { Observation } from '../../Model/Observation';\r\nimport { Feature } from '../../Model/Feature';\r\n\r\n\r\nexport default class ObservationItem extends React.Component<IObservationItemProps, IObservationItemState> {\r\n\r\n    color: Color;\r\n    observation: Observation;\r\n    feature: Feature;\r\n\r\n    styles = {\r\n        feature_card: {\r\n        },\r\n        card_content: {\r\n            padding: '10px',\r\n        },\r\n    };\r\n\r\n    constructor(props: IObservationItemProps) {\r\n        super(props);\r\n        this.color = this.props.color;\r\n        this.observation = this.props.observation;\r\n        this.feature = this.observation.getFeature();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Card style={this.styles.feature_card} >\r\n                <CardContent style={this.styles.card_content}>\r\n                    <Grid container alignItems='center'>\r\n                        <Grid item xl={2} lg={2} md={2} sm={2} xs={2}>\r\n                            <Avatar style={{ backgroundColor: this.color.getHex() }}>\r\n                                <FontAwesomeIcon icon={faThermometerHalf} />\r\n                            </Avatar>\r\n                        </Grid>\r\n                        <Grid item xl={10} lg={10} md={10} sm={10} xs={10}>\r\n                            <Typography color='textSecondary'>{this.feature.getName()}</Typography>\r\n                            <Typography variant='subtitle1'>{this.observation.getValue() + ' ' + this.feature.getUnitOfMeasurement()}</Typography>\r\n                        </Grid>\r\n                    </Grid>\r\n                </CardContent>\r\n            </Card>\r\n        );\r\n    }\r\n}\r\n\r\ninterface IObservationItemProps {\r\n    color: Color;\r\n    observation: Observation;\r\n}\r\n\r\ninterface IObservationItemState { }","import React from 'react';\r\n\r\nimport { Card } from '@material-ui/core';\r\n\r\nimport { Map, TileLayer, Marker } from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport Leaflet from 'leaflet';\r\n\r\nimport { Position } from '../../Model/Position';\r\n\r\n\r\n\r\nexport default class LocationMap extends React.Component<ILocationMapProps, ILocationMapState> {\r\n\r\n    //geo coordinates that will be marked on the map\r\n    position: Leaflet.LatLng;\r\n\r\n    //zoom level of the map\r\n    private static readonly ZOOM_LEVEL = 20;\r\n\r\n    // server that provides tiles to render the map\r\n    private static readonly TILE_SERVER = 'https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png';\r\n    private static readonly TILE_SERVER_ATTRIBUTION = '&copy; <a href=\"https://www..org/copyright\">OpenStreetMap</a>';\r\n\r\n    // custom icon to show position\r\n    private static readonly MARKER_ICON_PATH = './marker_icon.svg'; //path to the icon image\r\n    private static readonly MARKER_ICON_SIZE = 48; //width and height of the marker icon\r\n\r\n    static MARKER_ICON = new Leaflet.Icon({\r\n        iconUrl: require('' + LocationMap.MARKER_ICON_PATH),\r\n        iconSize: [LocationMap.MARKER_ICON_SIZE, LocationMap.MARKER_ICON_SIZE], // size of the icon\r\n        iconAnchor: [LocationMap.MARKER_ICON_SIZE / 2, LocationMap.MARKER_ICON_SIZE], // point of the icon which will correspond to marker's location\r\n    });\r\n\r\n    constructor(props: ILocationMapProps) {\r\n        super(props);\r\n        this.position = new Leaflet.LatLng(this.props.position.getLatitude(), this.props.position.getLongitude());\r\n    }\r\n\r\n    // custom css styles\r\n    styles = {\r\n        map: {\r\n            height: '300px',\r\n        },\r\n    }\r\n\r\n    //render component as JSX.Element\r\n    render() {\r\n        return (\r\n            <Card>\r\n                <Map\r\n                    center={this.position} //center map to the required position\r\n                    zoom={LocationMap.ZOOM_LEVEL} //set zoom\r\n                    style={this.styles.map} //provide custom styles\r\n\r\n                    // diable zooming via mouse and keyboard and disable dragging\r\n                    scrollWheelZoom={false}\r\n                    dragging={false}\r\n                    keyboard={false}\r\n                    doubleClickZoom={false}\r\n                >\r\n                    <TileLayer\r\n                        url={LocationMap.TILE_SERVER}\r\n                        attribution={LocationMap.TILE_SERVER_ATTRIBUTION}\r\n                    />\r\n                    <Marker\r\n                        position={this.position}\r\n                        icon={LocationMap.MARKER_ICON}\r\n                    />\r\n                </Map>\r\n            </Card>\r\n        );\r\n    }\r\n}\r\n\r\ninterface ILocationMapProps {\r\n    position: Position;\r\n}\r\n\r\ninterface ILocationMapState {\r\n}","import React from 'react';\r\nimport { Card, Divider, Typography, Grid, CircularProgress, Select, MenuItem, } from '@material-ui/core';\r\nimport Chart from \"react-google-charts\";\r\n\r\nimport IDiagramController from '../../Controller/DiagramController/DiagramController';\r\n\r\nexport default class Diagram extends React.Component<IDiagramProps, IDiagramState> {\r\n    //controller for this diagram\r\n    controller: IDiagramController;\r\n\r\n    constructor(props: IDiagramProps) {\r\n        super(props);\r\n        this.controller = this.props.controller;\r\n\r\n        //setup default configuration in state\r\n        this.state = {\r\n            configurationOption: this.controller.getDefaultConfigurationOption(),\r\n        }\r\n\r\n        this.handleConfigurationChange = this.handleConfigurationChange.bind(this);\r\n    }\r\n\r\n    //styles of this component\r\n    styles = {\r\n        header: {\r\n            padding: '10px',\r\n            paddingLeft: '40px',\r\n        },\r\n        diagram: {\r\n            width: '100%',\r\n            height: '350px',\r\n        },\r\n    };\r\n\r\n    //change configuration in state\r\n    handleConfigurationChange(event: React.ChangeEvent<{ value: unknown }>) {\r\n        this.setState({\r\n            configurationOption: (event.target.value as string),\r\n        });\r\n    }\r\n\r\n    //return configuration options as menu items\r\n    renderConfigurationOptions() {\r\n        var configurationOptions = this.controller.getConfigurationOptions();\r\n        return (\r\n            configurationOptions.map((option) =>\r\n                <MenuItem value={option}>{option}</MenuItem>\r\n            )\r\n        );\r\n    }\r\n\r\n    //renders the configuration form of this diagram\r\n    renderDiagramConfiguration() {\r\n        //if configuration is enabled return slect form with configuration options\r\n        if (this.controller.isConfigurable()) {\r\n            return (\r\n                <Grid item>\r\n                    <Select\r\n                        value={this.state.configurationOption}\r\n                        onChange={this.handleConfigurationChange}\r\n                    >\r\n                        {this.renderConfigurationOptions()}\r\n                    </Select>\r\n                </Grid>\r\n            );\r\n            //not configurable return empty string\r\n        } else return ('');\r\n    }\r\n\r\n    //render component\r\n    render() {\r\n        return (\r\n            <Card>\r\n                <div style={this.styles.header}>\r\n                    <Grid container justify='space-between' alignItems='center'>\r\n                        <Grid item>\r\n                            <Typography variant='subtitle1'>{this.controller.feature.getName()}</Typography>\r\n                        </Grid>\r\n                        {this.renderDiagramConfiguration()}\r\n                    </Grid>\r\n                </div>\r\n                <Divider />\r\n                <Chart\r\n                    width={this.styles.diagram.width}\r\n                    height={this.styles.diagram.height}\r\n                    chartType={this.controller.getChartType()}\r\n                    options={this.controller.getGraphicsOptions()}\r\n                    loader={\r\n                        <Grid container justify='center' alignContent='center' style={this.styles.diagram}>\r\n                            <CircularProgress />\r\n                        </Grid>\r\n                    }\r\n                    data={this.controller.getData(this.state.configurationOption)}\r\n                />\r\n            </Card>\r\n        );\r\n    }\r\n}\r\n\r\nexport interface IDiagramProps {\r\n    controller: IDiagramController;\r\n}\r\n\r\ninterface IDiagramState {\r\n    configurationOption: string;\r\n}"],"sourceRoot":""}